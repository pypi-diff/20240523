# Comparing `tmp/odoo_addon_l10n_es_vat_prorate-16.0.1.0.1.7-py3-none-any.whl.zip` & `tmp/odoo_addon_l10n_es_vat_prorate-17.0.1.0.0.2-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,49 +1,49 @@
-Zip file size: 47121 bytes, number of entries: 47
--rw-r--r--  2.0 unx     3199 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/README.rst
--rw-r--r--  2.0 unx       21 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/__init__.py
--rw-r--r--  2.0 unx      719 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/__manifest__.py
--rw-r--r--  2.0 unx     9925 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/data/account_template_tax.xml
--rw-r--r--  2.0 unx     5248 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/i18n/ca.po
--rw-r--r--  2.0 unx     5280 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/i18n/es.po
--rw-r--r--  2.0 unx     4571 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/i18n/l10n_es_vat_prorate.pot
--rw-r--r--  2.0 unx       79 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/models/__init__.py
--rw-r--r--  2.0 unx     3026 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/models/account_move.py
--rw-r--r--  2.0 unx     4160 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/models/account_tax.py
--rw-r--r--  2.0 unx     1547 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/models/res_company.py
--rw-r--r--  2.0 unx      190 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/readme/CONFIGURE.rst
--rw-r--r--  2.0 unx      104 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx       67 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx       38 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/readme/ROADMAP.rst
--rw-r--r--  2.0 unx      311 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/security/ir.model.access.csv
--rw-r--r--  2.0 unx     9455 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/static/description/icon.png
--rw-r--r--  2.0 unx    12874 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/static/description/index.html
--rw-r--r--  2.0 unx       62 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/__init__.py
--rw-r--r--  2.0 unx     4512 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/test_prorate_sii.py
--rw-r--r--  2.0 unx     7471 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/test_vat_prorate.py
--rw-r--r--  2.0 unx      736 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_invoice_p_iva0_ns_p_iva10_bc_dict.json
--rw-r--r--  2.0 unx      701 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_invoice_p_iva10_bc_dict.json
--rw-r--r--  2.0 unx      787 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_invoice_p_iva10_bc_p_irpf19_p_iva21_sc_p_irpf19_dict.json
--rw-r--r--  2.0 unx      701 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_invoice_p_iva10_bc_p_irpf1_dict.json
--rw-r--r--  2.0 unx     1096 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_invoice_p_iva10_bc_p_req014_p_iva21_sc_p_req52_dict.json
--rw-r--r--  2.0 unx      710 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_invoice_p_iva21_sp_ex_dict.json
--rw-r--r--  2.0 unx      734 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_refund_p_iva10_bc_dict.json
--rw-r--r--  2.0 unx      734 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_refund_p_iva21_sp_in_dict.json
--rw-r--r--  2.0 unx      921 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_invoice_s_iva0_sp_i_s_iva0_ic_dict.json
--rw-r--r--  2.0 unx      871 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_invoice_s_iva10b_dict.json
--rw-r--r--  2.0 unx      871 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_invoice_s_iva10b_s_irpf1_dict.json
--rw-r--r--  2.0 unx      871 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_invoice_s_iva10b_s_iva0_ns_dict.json
--rw-r--r--  2.0 unx     1362 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_invoice_s_iva10b_s_iva21s_dict.json
--rw-r--r--  2.0 unx     1573 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_invoice_s_iva10b_s_req014_s_iva21s_s_req52_dict.json
--rw-r--r--  2.0 unx      921 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_invoice_s_iva_e_s_iva0_e_dict.json
--rw-r--r--  2.0 unx      956 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_refund_s_iva0_sp_i_s_iva0_ic_dict.json
--rw-r--r--  2.0 unx     1397 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_refund_s_iva10b_s_iva10b_s_iva21s_dict.json
--rw-r--r--  2.0 unx      956 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_refund_s_iva_e_s_iva0_e_dict.json
--rw-r--r--  2.0 unx      707 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/views/account_move_views.xml
--rw-r--r--  2.0 unx     1017 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/views/account_tax_views.xml
--rw-r--r--  2.0 unx     1201 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/views/res_company_prorate_views.xml
--rw-r--r--  2.0 unx      949 b- defN 24-Mar-23 04:45 odoo/addons/l10n_es_vat_prorate/views/res_company_views.xml
--rw-r--r--  2.0 unx     3831 b- defN 24-Mar-23 04:45 odoo_addon_l10n_es_vat_prorate-16.0.1.0.1.7.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-Mar-23 04:45 odoo_addon_l10n_es_vat_prorate-16.0.1.0.1.7.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 24-Mar-23 04:45 odoo_addon_l10n_es_vat_prorate-16.0.1.0.1.7.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     5768 b- defN 24-Mar-23 04:45 odoo_addon_l10n_es_vat_prorate-16.0.1.0.1.7.dist-info/RECORD
-47 files, 103327 bytes uncompressed, 37173 bytes compressed:  64.0%
+Zip file size: 46796 bytes, number of entries: 47
+-rw-r--r--  2.0 unx     3275 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/README.rst
+-rw-r--r--  2.0 unx       21 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/__init__.py
+-rw-r--r--  2.0 unx      678 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/__manifest__.py
+-rw-r--r--  2.0 unx     5248 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/i18n/ca.po
+-rw-r--r--  2.0 unx     5280 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/i18n/es.po
+-rw-r--r--  2.0 unx     3868 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/i18n/l10n_es_vat_prorate.pot
+-rw-r--r--  2.0 unx      107 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/models/__init__.py
+-rw-r--r--  2.0 unx     3026 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/models/account_move.py
+-rw-r--r--  2.0 unx     1915 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/models/account_tax.py
+-rw-r--r--  2.0 unx     3214 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/models/prorate_taxes.py
+-rw-r--r--  2.0 unx     2383 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/models/res_company.py
+-rw-r--r--  2.0 unx      195 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/readme/CONFIGURE.md
+-rw-r--r--  2.0 unx      154 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/readme/CONTRIBUTORS.md
+-rw-r--r--  2.0 unx       67 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/readme/DESCRIPTION.md
+-rw-r--r--  2.0 unx       38 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/readme/ROADMAP.md
+-rw-r--r--  2.0 unx      311 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/security/ir.model.access.csv
+-rw-r--r--  2.0 unx     9455 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/static/description/icon.png
+-rw-r--r--  2.0 unx    12993 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/static/description/index.html
+-rw-r--r--  2.0 unx       62 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/__init__.py
+-rw-r--r--  2.0 unx     4593 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/test_prorate_sii.py
+-rw-r--r--  2.0 unx     8015 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/test_vat_prorate.py
+-rw-r--r--  2.0 unx      736 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_invoice_p_iva0_ns_p_iva10_bc_dict.json
+-rw-r--r--  2.0 unx      701 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_invoice_p_iva10_bc_dict.json
+-rw-r--r--  2.0 unx      787 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_invoice_p_iva10_bc_p_irpf19_p_iva21_sc_p_irpf19_dict.json
+-rw-r--r--  2.0 unx      701 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_invoice_p_iva10_bc_p_irpf1_dict.json
+-rw-r--r--  2.0 unx     1096 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_invoice_p_iva10_bc_p_req014_p_iva21_sc_p_req52_dict.json
+-rw-r--r--  2.0 unx      710 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_invoice_p_iva21_sp_ex_dict.json
+-rw-r--r--  2.0 unx      734 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_refund_p_iva10_bc_dict.json
+-rw-r--r--  2.0 unx      734 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_refund_p_iva21_sp_in_dict.json
+-rw-r--r--  2.0 unx      921 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_invoice_s_iva0_sp_i_s_iva0_ic_dict.json
+-rw-r--r--  2.0 unx      871 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_invoice_s_iva10b_dict.json
+-rw-r--r--  2.0 unx      871 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_invoice_s_iva10b_s_irpf1_dict.json
+-rw-r--r--  2.0 unx      871 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_invoice_s_iva10b_s_iva0_ns_dict.json
+-rw-r--r--  2.0 unx     1362 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_invoice_s_iva10b_s_iva21s_dict.json
+-rw-r--r--  2.0 unx     1573 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_invoice_s_iva10b_s_req014_s_iva21s_s_req52_dict.json
+-rw-r--r--  2.0 unx      921 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_invoice_s_iva_e_s_iva0_e_dict.json
+-rw-r--r--  2.0 unx      956 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_refund_s_iva0_sp_i_s_iva0_ic_dict.json
+-rw-r--r--  2.0 unx     1397 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_refund_s_iva10b_s_iva10b_s_iva21s_dict.json
+-rw-r--r--  2.0 unx      956 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_refund_s_iva_e_s_iva0_e_dict.json
+-rw-r--r--  2.0 unx      707 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/views/account_move_views.xml
+-rw-r--r--  2.0 unx      967 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/views/account_tax_views.xml
+-rw-r--r--  2.0 unx     1201 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/views/res_company_prorate_views.xml
+-rw-r--r--  2.0 unx      924 b- defN 24-May-23 16:19 odoo/addons/l10n_es_vat_prorate/views/res_company_views.xml
+-rw-r--r--  2.0 unx     3905 b- defN 24-May-23 16:19 odoo_addon_l10n_es_vat_prorate-17.0.1.0.0.2.dist-info/METADATA
+-rw-r--r--  2.0 unx       83 b- defN 24-May-23 16:19 odoo_addon_l10n_es_vat_prorate-17.0.1.0.0.2.dist-info/WHEEL
+-rw-r--r--  2.0 unx        4 b- defN 24-May-23 16:19 odoo_addon_l10n_es_vat_prorate-17.0.1.0.0.2.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     5758 b- defN 24-May-23 16:19 odoo_addon_l10n_es_vat_prorate-17.0.1.0.0.2.dist-info/RECORD
+47 files, 95345 bytes uncompressed, 36868 bytes compressed:  61.3%
```

## zipnote {}

```diff
@@ -3,17 +3,14 @@
 
 Filename: odoo/addons/l10n_es_vat_prorate/__init__.py
 Comment: 
 
 Filename: odoo/addons/l10n_es_vat_prorate/__manifest__.py
 Comment: 
 
-Filename: odoo/addons/l10n_es_vat_prorate/data/account_template_tax.xml
-Comment: 
-
 Filename: odoo/addons/l10n_es_vat_prorate/i18n/ca.po
 Comment: 
 
 Filename: odoo/addons/l10n_es_vat_prorate/i18n/es.po
 Comment: 
 
 Filename: odoo/addons/l10n_es_vat_prorate/i18n/l10n_es_vat_prorate.pot
@@ -24,27 +21,30 @@
 
 Filename: odoo/addons/l10n_es_vat_prorate/models/account_move.py
 Comment: 
 
 Filename: odoo/addons/l10n_es_vat_prorate/models/account_tax.py
 Comment: 
 
+Filename: odoo/addons/l10n_es_vat_prorate/models/prorate_taxes.py
+Comment: 
+
 Filename: odoo/addons/l10n_es_vat_prorate/models/res_company.py
 Comment: 
 
-Filename: odoo/addons/l10n_es_vat_prorate/readme/CONFIGURE.rst
+Filename: odoo/addons/l10n_es_vat_prorate/readme/CONFIGURE.md
 Comment: 
 
-Filename: odoo/addons/l10n_es_vat_prorate/readme/CONTRIBUTORS.rst
+Filename: odoo/addons/l10n_es_vat_prorate/readme/CONTRIBUTORS.md
 Comment: 
 
-Filename: odoo/addons/l10n_es_vat_prorate/readme/DESCRIPTION.rst
+Filename: odoo/addons/l10n_es_vat_prorate/readme/DESCRIPTION.md
 Comment: 
 
-Filename: odoo/addons/l10n_es_vat_prorate/readme/ROADMAP.rst
+Filename: odoo/addons/l10n_es_vat_prorate/readme/ROADMAP.md
 Comment: 
 
 Filename: odoo/addons/l10n_es_vat_prorate/security/ir.model.access.csv
 Comment: 
 
 Filename: odoo/addons/l10n_es_vat_prorate/static/description/icon.png
 Comment: 
@@ -123,20 +123,20 @@
 
 Filename: odoo/addons/l10n_es_vat_prorate/views/res_company_prorate_views.xml
 Comment: 
 
 Filename: odoo/addons/l10n_es_vat_prorate/views/res_company_views.xml
 Comment: 
 
-Filename: odoo_addon_l10n_es_vat_prorate-16.0.1.0.1.7.dist-info/METADATA
+Filename: odoo_addon_l10n_es_vat_prorate-17.0.1.0.0.2.dist-info/METADATA
 Comment: 
 
-Filename: odoo_addon_l10n_es_vat_prorate-16.0.1.0.1.7.dist-info/WHEEL
+Filename: odoo_addon_l10n_es_vat_prorate-17.0.1.0.0.2.dist-info/WHEEL
 Comment: 
 
-Filename: odoo_addon_l10n_es_vat_prorate-16.0.1.0.1.7.dist-info/top_level.txt
+Filename: odoo_addon_l10n_es_vat_prorate-17.0.1.0.0.2.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo_addon_l10n_es_vat_prorate-16.0.1.0.1.7.dist-info/RECORD
+Filename: odoo_addon_l10n_es_vat_prorate-17.0.1.0.0.2.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/l10n_es_vat_prorate/README.rst

```diff
@@ -3,92 +3,97 @@
 ===============
 
 .. 
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    !! This file is generated by oca-gen-addon-readme !!
    !! changes will be overwritten.                   !!
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-   !! source digest: sha256:59f1ace90d09cc30ce3bf2a8cdb9d9c5670648913348b64eb9980c4ffb977bff
+   !! source digest: sha256:b8a9dfc85a9b4feccddea9071f322082477f7da47c8e24a1888a842545af81ab
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 
 .. |badge1| image:: https://img.shields.io/badge/maturity-Beta-yellow.png
     :target: https://odoo-community.org/page/development-status
     :alt: Beta
 .. |badge2| image:: https://img.shields.io/badge/licence-AGPL--3-blue.png
     :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
     :alt: License: AGPL-3
 .. |badge3| image:: https://img.shields.io/badge/github-OCA%2Fl10n--spain-lightgray.png?logo=github
-    :target: https://github.com/OCA/l10n-spain/tree/16.0/l10n_es_vat_prorate
+    :target: https://github.com/OCA/l10n-spain/tree/17.0/l10n_es_vat_prorate
     :alt: OCA/l10n-spain
 .. |badge4| image:: https://img.shields.io/badge/weblate-Translate%20me-F47D42.png
-    :target: https://translation.odoo-community.org/projects/l10n-spain-16-0/l10n-spain-16-0-l10n_es_vat_prorate
+    :target: https://translation.odoo-community.org/projects/l10n-spain-17-0/l10n-spain-17-0-l10n_es_vat_prorate
     :alt: Translate me on Weblate
 .. |badge5| image:: https://img.shields.io/badge/runboat-Try%20me-875A7B.png
-    :target: https://runboat.odoo-community.org/builds?repo=OCA/l10n-spain&target_branch=16.0
+    :target: https://runboat.odoo-community.org/builds?repo=OCA/l10n-spain&target_branch=17.0
     :alt: Try me on Runboat
 
 |badge1| |badge2| |badge3| |badge4| |badge5|
 
 El módulo nos divide los IVA según la prorrata de la compañía.
 
 **Table of contents**
 
 .. contents::
    :local:
 
 Configuration
 =============
 
-* Accede a la companía y marca que aplica prorrata
-* Define el porcentaje de prorata (se aplica por fechas)
+-  Accede a la companía y marca que aplica prorrata
+-  Define el porcentaje de prorrata (se aplica por fechas)
 
-Los impuestos de las facturas de cliente se dividiran según la prorata activa.
+Los impuestos de las facturas de proveedor se dividirán según la
+prorrata activa.
 
 Known issues / Roadmap
 ======================
 
-- No compatible con criterio de caja.
+-  No compatible con criterio de caja.
 
 Bug Tracker
 ===========
 
 Bugs are tracked on `GitHub Issues <https://github.com/OCA/l10n-spain/issues>`_.
 In case of trouble, please check there if your issue has already been reported.
 If you spotted it first, help us to smash it by providing a detailed and welcomed
-`feedback <https://github.com/OCA/l10n-spain/issues/new?body=module:%20l10n_es_vat_prorate%0Aversion:%2016.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.
+`feedback <https://github.com/OCA/l10n-spain/issues/new?body=module:%20l10n_es_vat_prorate%0Aversion:%2017.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.
 
 Do not contact contributors directly about support or help with technical issues.
 
 Credits
 =======
 
 Authors
-~~~~~~~
+-------
 
 * Creu Blanca
 * Tecnativa
 
 Contributors
-~~~~~~~~~~~~
+------------
 
-* Enric Tobella
-* `Tecnativa <https://www.tecnativa.com/>`_:
+-  Enric Tobella
+-  `Tecnativa <https://www.tecnativa.com/>`__:
 
-  * Pedro M. Baeza
-  * Carolina Fernandez
+   -  Pedro M. Baeza
+   -  Carolina Fernandez
+
+-  `Sygel <https://www.sygel.es/>`__:
+
+   -  Manuel Regidor
 
 Maintainers
-~~~~~~~~~~~
+-----------
 
 This module is maintained by the OCA.
 
 .. image:: https://odoo-community.org/logo.png
    :alt: Odoo Community Association
    :target: https://odoo-community.org
 
 OCA, or the Odoo Community Association, is a nonprofit organization whose
 mission is to support the collaborative development of Odoo features and
 promote its widespread use.
 
-This module is part of the `OCA/l10n-spain <https://github.com/OCA/l10n-spain/tree/16.0/l10n_es_vat_prorate>`_ project on GitHub.
+This module is part of the `OCA/l10n-spain <https://github.com/OCA/l10n-spain/tree/17.0/l10n_es_vat_prorate>`_ project on GitHub.
 
 You are welcome to contribute. To learn how please visit https://odoo-community.org/page/Contribute.
```

## odoo/addons/l10n_es_vat_prorate/__manifest__.py

```diff
@@ -1,21 +1,20 @@
 # Copyright 2022 Creu Blanca
 # Copyright 2023 Tecnativa - Pedro M. Baeza
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl).
 
 {
     "name": "Prorrata de IVA",
     "summary": "Prorrata de IVA para la localización española",
-    "version": "16.0.1.0.1",
+    "version": "17.0.1.0.0",
     "license": "AGPL-3",
     "author": "Creu Blanca, Tecnativa, Odoo Community Association (OCA)",
     "website": "https://github.com/OCA/l10n-spain",
     "depends": ["l10n_es_aeat"],
     "data": [
         "security/ir.model.access.csv",
-        "data/account_template_tax.xml",
         "views/account_move_views.xml",
         "views/account_tax_views.xml",
         "views/res_company_prorate_views.xml",
         "views/res_company_views.xml",
     ],
 }
```

## odoo/addons/l10n_es_vat_prorate/i18n/l10n_es_vat_prorate.pot

```diff
@@ -1,14 +1,14 @@
 # Translation of Odoo Server.
 # This file contains the translation of the following modules:
 # 	* l10n_es_vat_prorate
 #
 msgid ""
 msgstr ""
-"Project-Id-Version: Odoo Server 16.0\n"
+"Project-Id-Version: Odoo Server 17.0\n"
 "Report-Msgid-Bugs-To: \n"
 "Last-Translator: \n"
 "Language-Team: \n"
 "MIME-Version: 1.0\n"
 "Content-Type: text/plain; charset=UTF-8\n"
 "Content-Transfer-Encoding: \n"
 "Plural-Forms: \n"
@@ -60,19 +60,14 @@
 
 #. module: l10n_es_vat_prorate
 #: model:ir.model,name:l10n_es_vat_prorate.model_account_move_line
 msgid "Journal Item"
 msgstr ""
 
 #. module: l10n_es_vat_prorate
-#: model:ir.model.fields,field_description:l10n_es_vat_prorate.field_res_company_vat_prorate____last_update
-msgid "Last Modified on"
-msgstr ""
-
-#. module: l10n_es_vat_prorate
 #: model:ir.model.fields,field_description:l10n_es_vat_prorate.field_res_company_vat_prorate__write_uid
 msgid "Last Updated by"
 msgstr ""
 
 #. module: l10n_es_vat_prorate
 #: model:ir.model.fields,field_description:l10n_es_vat_prorate.field_res_company_vat_prorate__write_date
 msgid "Last Updated on"
@@ -80,34 +75,19 @@
 
 #. module: l10n_es_vat_prorate
 #: model:ir.model.fields,field_description:l10n_es_vat_prorate.field_account_tax__prorate_account_ids
 msgid "Prorate Account"
 msgstr ""
 
 #. module: l10n_es_vat_prorate
-#: model:ir.model.fields,field_description:l10n_es_vat_prorate.field_account_tax_template__prorate_account_template_ids
-msgid "Prorate Account Template"
-msgstr ""
-
-#. module: l10n_es_vat_prorate
 #: model:ir.model,name:l10n_es_vat_prorate.model_account_tax
 msgid "Tax"
 msgstr ""
 
 #. module: l10n_es_vat_prorate
-#: model:ir.model.fields,field_description:l10n_es_vat_prorate.field_account_tax_template__template_with_vat_prorate
-msgid "Template With Vat Prorate"
-msgstr ""
-
-#. module: l10n_es_vat_prorate
-#: model:ir.model,name:l10n_es_vat_prorate.model_account_tax_template
-msgid "Templates for Taxes"
-msgstr ""
-
-#. module: l10n_es_vat_prorate
 #: model_terms:ir.ui.view,arch_db:l10n_es_vat_prorate.res_company_form_view
 msgid "VAT Prorate"
 msgstr ""
 
 #. module: l10n_es_vat_prorate
 #: model:ir.model,name:l10n_es_vat_prorate.model_res_company_vat_prorate
 msgid "VAT Prorate table"
```

## odoo/addons/l10n_es_vat_prorate/models/__init__.py

```diff
@@ -1,3 +1,4 @@
 from . import res_company
 from . import account_move
 from . import account_tax
+from . import prorate_taxes
```

## odoo/addons/l10n_es_vat_prorate/models/account_tax.py

```diff
@@ -1,13 +1,16 @@
 # Copyright 2022 Creu Blanca
 # Copyright 2023 Tecnativa - Pedro M. Baeza
+# Copyright 2024 Sygel - Manuel Regidor
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl).
 
+
 from odoo import api, fields, models
-from odoo.tools import ormcache
+
+from .prorate_taxes import PRORATE_TAXES
 
 
 class AccountTax(models.Model):
     _inherit = "account.tax"
 
     with_vat_prorate = fields.Boolean(
         compute="_compute_with_vat_prorate", store=True, readonly=False
@@ -23,87 +26,26 @@
         related="company_id.with_vat_prorate",
         string="Company with VAT prorate",
     )
 
     @api.depends("company_id.with_vat_prorate")
     def _compute_with_vat_prorate(self):
         for tax in self:
-            if tax.company_id.with_vat_prorate:
-                tax_template_ids = self.env[
-                    "account.tax.template"
-                ]._get_vat_prorate_template_xmlids()
-                xmlids = self.env["ir.model.data"].search_read(
-                    [("model", "=", tax._name), ("res_id", "=", tax.id)],
-                    ["name", "module"],
-                    limit=1,
+            with_vat_prorate = False
+            prorate_account_ids = []
+            if tax.company_with_vat_prorate and tax.get_external_id().get(tax.id):
+                xml_id = (
+                    tax.get_external_id()
+                    .get(tax.id)
+                    .split(f"account.{tax.company_id.id}_")[-1]
                 )
-                if xmlids:
-                    xmlid = xmlids[0]
-                    tax_ref = "{}.{}".format(
-                        xmlid["module"], xmlid["name"].split("_", 1)[1]
-                    )
-                    with_vat_prorate = tax_ref in tax_template_ids
-                    prorate_account_ids = [(5, 0, 0)]
-                    if with_vat_prorate:
-                        tax_template = self.env.ref(tax_ref)
-                        for (
-                            template_account
-                        ) in tax_template.prorate_account_template_ids:
-                            template_account_xmlids = self.env[
-                                "ir.model.data"
-                            ].search_read(
-                                [
-                                    ("model", "=", template_account._name),
-                                    ("res_id", "=", template_account.id),
-                                ],
-                                ["name", "module"],
-                                limit=1,
-                            )
-                            if template_account_xmlids:
-                                account = self.env.ref(
-                                    "{}.{}_{}".format(
-                                        template_account_xmlids[0]["module"],
-                                        tax.company_id.id,
-                                        template_account_xmlids[0]["name"],
-                                    ),
-                                    raise_if_not_found=False,
-                                )
-                                if account:
-                                    prorate_account_ids.append((4, account.id))
-
-                    tax.with_vat_prorate = with_vat_prorate
-                    tax.prorate_account_ids = prorate_account_ids
-                    continue
-            tax.with_vat_prorate = False
-            tax.prorate_account_ids = False
-
-
-class AccountTaxTemplate(models.Model):
-    _inherit = "account.tax.template"
-
-    template_with_vat_prorate = fields.Boolean()
-
-    prorate_account_template_ids = fields.Many2many("account.account.template")
-    # Name must be different that the account.tax field in order to make it
-    # compatible with account_chart_update
-
-    @ormcache()
-    def _get_vat_prorate_template_xmlids(self):
-        templates = self.env["account.tax.template"].search(
-            [("template_with_vat_prorate", "=", True)]
-        )
-        data = templates._get_external_ids()
-        result = []
-        for key in data:
-            result += data[key]
-        return result
-
-    @api.model_create_multi
-    def create(self, vals_list):
-        result = super().create(vals_list)
-        self.clear_caches()
-        return result
-
-    def write(self, vals):
-        result = super().write(vals)
-        self.clear_caches()
-        return result
+                if xml_id in PRORATE_TAXES:
+                    with_vat_prorate = True
+                    if PRORATE_TAXES.get(xml_id).get("prorate_account_template_ids"):
+                        prorate_taxes = self.company_id._get_prorate_accounts()
+                        prorate_account_ids = [(5, 0, 0)]
+                        for account_from_tmpl_id in prorate_taxes.get(xml_id).get(
+                            "prorate_account_ids"
+                        ):
+                            prorate_account_ids.append((4, account_from_tmpl_id))
+            tax.with_vat_prorate = with_vat_prorate
+            tax.prorate_account_ids = prorate_account_ids
```

## odoo/addons/l10n_es_vat_prorate/models/res_company.py

```diff
@@ -1,23 +1,42 @@
 # Copyright 2022 Creu Blanca
 # Copyright 2023 Tecnativa Carolina Fernandez
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl).
 
 from odoo import _, api, fields, models
 from odoo.exceptions import ValidationError
+from odoo.tools import ormcache
+
+from .prorate_taxes import PRORATE_TAXES
 
 
 class ResCompany(models.Model):
     _inherit = "res.company"
 
     with_vat_prorate = fields.Boolean()
     vat_prorate_ids = fields.One2many(
         "res.company.vat.prorate", inverse_name="company_id"
     )
 
+    @ormcache("self")
+    def _get_prorate_accounts(self):
+        prorate_taxes_mapping = {}
+        for tax_tmpl in PRORATE_TAXES:
+            if PRORATE_TAXES.get(tax_tmpl).get("prorate_account_template_ids"):
+                prorate_account_ids = []
+                vals = PRORATE_TAXES.get(tax_tmpl)
+                for account_tmpl in vals.get("prorate_account_template_ids"):
+                    account_from_tmpl_id = self._get_account_id_from_xmlid(account_tmpl)
+                    if account_from_tmpl_id:
+                        prorate_account_ids.append(account_from_tmpl_id)
+                prorate_taxes_mapping[tax_tmpl] = {
+                    "prorate_account_ids": prorate_account_ids,
+                }
+        return prorate_taxes_mapping
+
     def get_prorate(self, date):
         self.ensure_one()
         prorate = self.env["res.company.vat.prorate"].search(
             [("company_id", "=", self.id), ("date", "<=", date)],
             order="date DESC",
             limit=1,
         )
```

## odoo/addons/l10n_es_vat_prorate/static/description/index.html

```diff
@@ -362,17 +362,17 @@
 <div class="document" id="prorrata-de-iva">
 <h1 class="title">Prorrata de IVA</h1>
 
 <!-- !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 !! This file is generated by oca-gen-addon-readme !!
 !! changes will be overwritten.                   !!
 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-!! source digest: sha256:59f1ace90d09cc30ce3bf2a8cdb9d9c5670648913348b64eb9980c4ffb977bff
+!! source digest: sha256:b8a9dfc85a9b4feccddea9071f322082477f7da47c8e24a1888a842545af81ab
 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -->
-<p><a class="reference external image-reference" href="https://odoo-community.org/page/development-status"><img alt="Beta" src="https://img.shields.io/badge/maturity-Beta-yellow.png" /></a> <a class="reference external image-reference" href="http://www.gnu.org/licenses/agpl-3.0-standalone.html"><img alt="License: AGPL-3" src="https://img.shields.io/badge/licence-AGPL--3-blue.png" /></a> <a class="reference external image-reference" href="https://github.com/OCA/l10n-spain/tree/16.0/l10n_es_vat_prorate"><img alt="OCA/l10n-spain" src="https://img.shields.io/badge/github-OCA%2Fl10n--spain-lightgray.png?logo=github" /></a> <a class="reference external image-reference" href="https://translation.odoo-community.org/projects/l10n-spain-16-0/l10n-spain-16-0-l10n_es_vat_prorate"><img alt="Translate me on Weblate" src="https://img.shields.io/badge/weblate-Translate%20me-F47D42.png" /></a> <a class="reference external image-reference" href="https://runboat.odoo-community.org/builds?repo=OCA/l10n-spain&amp;target_branch=16.0"><img alt="Try me on Runboat" src="https://img.shields.io/badge/runboat-Try%20me-875A7B.png" /></a></p>
+<p><a class="reference external image-reference" href="https://odoo-community.org/page/development-status"><img alt="Beta" src="https://img.shields.io/badge/maturity-Beta-yellow.png" /></a> <a class="reference external image-reference" href="http://www.gnu.org/licenses/agpl-3.0-standalone.html"><img alt="License: AGPL-3" src="https://img.shields.io/badge/licence-AGPL--3-blue.png" /></a> <a class="reference external image-reference" href="https://github.com/OCA/l10n-spain/tree/17.0/l10n_es_vat_prorate"><img alt="OCA/l10n-spain" src="https://img.shields.io/badge/github-OCA%2Fl10n--spain-lightgray.png?logo=github" /></a> <a class="reference external image-reference" href="https://translation.odoo-community.org/projects/l10n-spain-17-0/l10n-spain-17-0-l10n_es_vat_prorate"><img alt="Translate me on Weblate" src="https://img.shields.io/badge/weblate-Translate%20me-F47D42.png" /></a> <a class="reference external image-reference" href="https://runboat.odoo-community.org/builds?repo=OCA/l10n-spain&amp;target_branch=17.0"><img alt="Try me on Runboat" src="https://img.shields.io/badge/runboat-Try%20me-875A7B.png" /></a></p>
 <p>El módulo nos divide los IVA según la prorrata de la compañía.</p>
 <p><strong>Table of contents</strong></p>
 <div class="contents local topic" id="contents">
 <ul class="simple">
 <li><a class="reference internal" href="#configuration" id="toc-entry-1">Configuration</a></li>
 <li><a class="reference internal" href="#known-issues-roadmap" id="toc-entry-2">Known issues / Roadmap</a></li>
 <li><a class="reference internal" href="#bug-tracker" id="toc-entry-3">Bug Tracker</a></li>
@@ -384,30 +384,31 @@
 </li>
 </ul>
 </div>
 <div class="section" id="configuration">
 <h1><a class="toc-backref" href="#toc-entry-1">Configuration</a></h1>
 <ul class="simple">
 <li>Accede a la companía y marca que aplica prorrata</li>
-<li>Define el porcentaje de prorata (se aplica por fechas)</li>
+<li>Define el porcentaje de prorrata (se aplica por fechas)</li>
 </ul>
-<p>Los impuestos de las facturas de cliente se dividiran según la prorata activa.</p>
+<p>Los impuestos de las facturas de proveedor se dividirán según la
+prorrata activa.</p>
 </div>
 <div class="section" id="known-issues-roadmap">
 <h1><a class="toc-backref" href="#toc-entry-2">Known issues / Roadmap</a></h1>
 <ul class="simple">
 <li>No compatible con criterio de caja.</li>
 </ul>
 </div>
 <div class="section" id="bug-tracker">
 <h1><a class="toc-backref" href="#toc-entry-3">Bug Tracker</a></h1>
 <p>Bugs are tracked on <a class="reference external" href="https://github.com/OCA/l10n-spain/issues">GitHub Issues</a>.
 In case of trouble, please check there if your issue has already been reported.
 If you spotted it first, help us to smash it by providing a detailed and welcomed
-<a class="reference external" href="https://github.com/OCA/l10n-spain/issues/new?body=module:%20l10n_es_vat_prorate%0Aversion:%2016.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**">feedback</a>.</p>
+<a class="reference external" href="https://github.com/OCA/l10n-spain/issues/new?body=module:%20l10n_es_vat_prorate%0Aversion:%2017.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**">feedback</a>.</p>
 <p>Do not contact contributors directly about support or help with technical issues.</p>
 </div>
 <div class="section" id="credits">
 <h1><a class="toc-backref" href="#toc-entry-4">Credits</a></h1>
 <div class="section" id="authors">
 <h2><a class="toc-backref" href="#toc-entry-5">Authors</a></h2>
 <ul class="simple">
@@ -420,23 +421,27 @@
 <ul class="simple">
 <li>Enric Tobella</li>
 <li><a class="reference external" href="https://www.tecnativa.com/">Tecnativa</a>:<ul>
 <li>Pedro M. Baeza</li>
 <li>Carolina Fernandez</li>
 </ul>
 </li>
+<li><a class="reference external" href="https://www.sygel.es/">Sygel</a>:<ul>
+<li>Manuel Regidor</li>
+</ul>
+</li>
 </ul>
 </div>
 <div class="section" id="maintainers">
 <h2><a class="toc-backref" href="#toc-entry-7">Maintainers</a></h2>
 <p>This module is maintained by the OCA.</p>
 <a class="reference external image-reference" href="https://odoo-community.org"><img alt="Odoo Community Association" src="https://odoo-community.org/logo.png" /></a>
 <p>OCA, or the Odoo Community Association, is a nonprofit organization whose
 mission is to support the collaborative development of Odoo features and
 promote its widespread use.</p>
-<p>This module is part of the <a class="reference external" href="https://github.com/OCA/l10n-spain/tree/16.0/l10n_es_vat_prorate">OCA/l10n-spain</a> project on GitHub.</p>
+<p>This module is part of the <a class="reference external" href="https://github.com/OCA/l10n-spain/tree/17.0/l10n_es_vat_prorate">OCA/l10n-spain</a> project on GitHub.</p>
 <p>You are welcome to contribute. To learn how please visit <a class="reference external" href="https://odoo-community.org/page/Contribute">https://odoo-community.org/page/Contribute</a>.</p>
 </div>
 </div>
 </div>
 </body>
 </html>
```

### html2text {}

```diff
@@ -8,16 +8,17 @@
     * _B_u_g_ _T_r_a_c_k_e_r
     * _C_r_e_d_i_t_s
           o _A_u_t_h_o_r_s
           o _C_o_n_t_r_i_b_u_t_o_r_s
           o _M_a_i_n_t_a_i_n_e_r_s
 ************ _CC_oo_nn_ff_ii_gg_uu_rr_aa_tt_ii_oo_nn ************
     * Accede a la companía y marca que aplica prorrata
-    * Define el porcentaje de prorata (se aplica por fechas)
-Los impuestos de las facturas de cliente se dividiran según la prorata activa.
+    * Define el porcentaje de prorrata (se aplica por fechas)
+Los impuestos de las facturas de proveedor se dividirán según la prorrata
+activa.
 ************ _KK_nn_oo_ww_nn_ _ii_ss_ss_uu_ee_ss_ _//_ _RR_oo_aa_dd_mm_aa_pp ************
     * No compatible con criterio de caja.
 ************ _BB_uu_gg_ _TT_rr_aa_cc_kk_ee_rr ************
 Bugs are tracked on _G_i_t_H_u_b_ _I_s_s_u_e_s. In case of trouble, please check there if
 your issue has already been reported. If you spotted it first, help us to smash
 it by providing a detailed and welcomed _f_e_e_d_b_a_c_k.
 Do not contact contributors directly about support or help with technical
@@ -27,14 +28,16 @@
     * Creu Blanca
     * Tecnativa
 ********** _CC_oo_nn_tt_rr_ii_bb_uu_tt_oo_rr_ss **********
     * Enric Tobella
     * _T_e_c_n_a_t_i_v_a:
           o Pedro M. Baeza
           o Carolina Fernandez
+    * _S_y_g_e_l:
+          o Manuel Regidor
 ********** _MM_aa_ii_nn_tt_aa_ii_nn_ee_rr_ss **********
 This module is maintained by the OCA.
 _[_O_d_o_o_ _C_o_m_m_u_n_i_t_y_ _A_s_s_o_c_i_a_t_i_o_n_]
 OCA, or the Odoo Community Association, is a nonprofit organization whose
 mission is to support the collaborative development of Odoo features and
 promote its widespread use.
 This module is part of the _O_C_A_/_l_1_0_n_-_s_p_a_i_n project on GitHub.
```

## odoo/addons/l10n_es_vat_prorate/tests/test_prorate_sii.py

```diff
@@ -1,16 +1,21 @@
 from datetime import date
 
 from odoo.tests.common import tagged
 
-from odoo.addons.l10n_es_aeat_sii_oca.tests import test_l10n_es_aeat_sii
+try:
+    from odoo.addons.l10n_es_aeat_sii_oca.tests.test_l10n_es_aeat_sii import (
+        TestL10nEsAeatSiiBase,
+    )
+except ImportError:
+    TestL10nEsAeatSiiBase = object
 
 
 @tagged("-at_install", "post_install")
-class TestSIIVatProrate(test_l10n_es_aeat_sii.TestL10nEsAeatSiiBase):
+class TestSIIVatProrate(TestL10nEsAeatSiiBase):
     @classmethod
     def setUpClass(cls):
         try:
             super().setUpClass()
         except Exception:
             cls.skipTest(cls, "l10n_es_aeat_sii_oca seems not installed")
         cls.company.write(
```

## odoo/addons/l10n_es_vat_prorate/tests/test_vat_prorate.py

```diff
@@ -14,15 +14,15 @@
 from odoo.addons.account.tests.common import AccountTestInvoicingCommon
 
 
 @tagged("post_install", "-at_install")
 class TestVatProrate(AccountTestInvoicingCommon):
     @classmethod
     def setUpClass(cls):
-        super().setUpClass(chart_template_ref="l10n_es.account_chart_template_pymes")
+        super().setUpClass(chart_template_ref="es_pymes")
         cls.env = cls.env(
             context=dict(
                 cls.env.context,
                 mail_create_nolog=True,
                 mail_create_nosubscribe=True,
                 mail_notrack=True,
                 no_reset_password=True,
@@ -52,18 +52,20 @@
             }
         )
 
     # Put `zzz` for making sure that the test is executed in last place, as the cursor
     # gets incoherent after returning from the SQL constraint violation
     @mute_logger("odoo.sql_db")
     def test_zzz_company_vat_prorate_out_of_range(self):
+        vat_prorate_line = self.env.company.vat_prorate_ids[0]
         with self.assertRaises(IntegrityError):
-            self.env.company.vat_prorate_ids[0].vat_prorate = 200
+            vat_prorate_line.vat_prorate = 200
 
     def test_no_company_vat_prorate_information(self):
+        self.assertTrue(self.env.company.vat_prorate_ids)
         with self.assertRaises(exceptions.ValidationError):
             self.env.company.write({"vat_prorate_ids": False})
 
     def test_no_prorate_in_invoice(self):
         self.env.company.write(
             {"with_vat_prorate": False}
         )  # We want to be sure that it is executed properly
@@ -87,14 +89,25 @@
             len(
                 invoice.line_ids.filtered(
                     lambda r: r.tax_line_id and r.analytic_distribution
                 )
             ),
         )
 
+    def test_prorate_tax_with_prorate_account(self):
+        # 21% EU S (Services) tax
+        tax = self.env.ref(
+            f"account.{self.env.company.id}_account_tax_template_p_iva21_sp_in"
+        )
+        invoice = self.init_invoice(
+            "in_invoice", products=[self.product_a, self.product_b], taxes=[tax]
+        )
+        self.assertEqual(7, len(invoice.line_ids))
+        self.assertEqual(4, len(invoice.line_ids.filtered(lambda r: r.tax_line_id)))
+
     def test_prorate_same_accounts_in_invoice(self):
         self.product_b.property_account_expense_id = self.company_data[
             "default_account_expense"
         ]
         invoice = self.init_invoice(
             "in_invoice", products=[self.product_a, self.product_b]
         )
```

## odoo/addons/l10n_es_vat_prorate/views/account_tax_views.xml

### odoo/addons/l10n_es_vat_prorate/views/account_tax_views.xml

```diff
@@ -4,14 +4,14 @@
 <odoo>
   <record model="ir.ui.view" id="account_tax_form_view">
     <field name="name">account.tax.form (in l10n_es_vat_prorate)</field>
     <field name="model">account.tax</field>
     <field name="inherit_id" ref="account.view_tax_form"/>
     <field name="arch" type="xml">
       <field name="tax_group_id" position="after">
-        <field name="with_vat_prorate" attrs="{'invisible': [('company_with_vat_prorate', '=', False)]}"/>
+        <field name="with_vat_prorate" invisible="not company_with_vat_prorate"/>
         <field name="company_with_vat_prorate" invisible="1"/>
-        <field name="prorate_account_ids" widget="many2many_tags" attrs="{'invisible': [('company_with_vat_prorate', '=', False)]}"/>
+        <field name="prorate_account_ids" widget="many2many_tags" invisible="not company_with_vat_prorate"/>
       </field>
     </field>
   </record>
 </odoo>
```

## odoo/addons/l10n_es_vat_prorate/views/res_company_views.xml

### odoo/addons/l10n_es_vat_prorate/views/res_company_views.xml

```diff
@@ -4,15 +4,15 @@
 <odoo>
   <record model="ir.ui.view" id="res_company_form_view">
     <field name="name">res.company.form (in l10n_es_vat_prorate)</field>
     <field name="model">res.company</field>
     <field name="inherit_id" ref="base.view_company_form"/>
     <field name="arch" type="xml">
       <notebook position="inside">
-        <page name="vat_prorate" string="VAT Prorate" attrs="{'invisible': [('with_vat_prorate', '=', False)]}">
+        <page name="vat_prorate" string="VAT Prorate" invisible="not with_vat_prorate">
           <field name="vat_prorate_ids"/>
         </page>
       </notebook>
       <field name="company_registry" position="after">
         <field name="with_vat_prorate"/>
       </field>
     </field>
```

## Comparing `odoo_addon_l10n_es_vat_prorate-16.0.1.0.1.7.dist-info/METADATA` & `odoo_addon_l10n_es_vat_prorate-17.0.1.0.0.2.dist-info/METADATA`

 * *Files 10% similar despite different names*

```diff
@@ -1,113 +1,115 @@
 Metadata-Version: 2.1
-Name: odoo-addon-l10n-es-vat-prorate
-Version: 16.0.1.0.1.7
-Summary: Prorrata de IVA para la localización española
+Name: odoo-addon-l10n_es_vat_prorate
+Version: 17.0.1.0.0.2
+Requires-Python: >=3.10
+Requires-Dist: odoo-addon-l10n_es_aeat>=17.0dev,<17.1dev
+Requires-Dist: odoo>=17.0a,<17.1dev
+Summary: =?utf-8?q?Prorrata_de_IVA_para_la_localizaci=C3=B3n_espa=C3=B1ola?=
 Home-page: https://github.com/OCA/l10n-spain
+License: AGPL-3
 Author: Creu Blanca, Tecnativa, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
-License: AGPL-3
-Platform: UNKNOWN
 Classifier: Programming Language :: Python
 Classifier: Framework :: Odoo
-Classifier: Framework :: Odoo :: 16.0
+Classifier: Framework :: Odoo :: 17.0
 Classifier: License :: OSI Approved :: GNU Affero General Public License v3
-Requires-Python: >=3.10
-Requires-Dist: odoo-addon-l10n-es-aeat <16.1dev,>=16.0dev
-Requires-Dist: odoo <16.1dev,>=16.0a
 
 ===============
 Prorrata de IVA
 ===============
 
 .. 
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    !! This file is generated by oca-gen-addon-readme !!
    !! changes will be overwritten.                   !!
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-   !! source digest: sha256:59f1ace90d09cc30ce3bf2a8cdb9d9c5670648913348b64eb9980c4ffb977bff
+   !! source digest: sha256:b8a9dfc85a9b4feccddea9071f322082477f7da47c8e24a1888a842545af81ab
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 
 .. |badge1| image:: https://img.shields.io/badge/maturity-Beta-yellow.png
     :target: https://odoo-community.org/page/development-status
     :alt: Beta
 .. |badge2| image:: https://img.shields.io/badge/licence-AGPL--3-blue.png
     :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
     :alt: License: AGPL-3
 .. |badge3| image:: https://img.shields.io/badge/github-OCA%2Fl10n--spain-lightgray.png?logo=github
-    :target: https://github.com/OCA/l10n-spain/tree/16.0/l10n_es_vat_prorate
+    :target: https://github.com/OCA/l10n-spain/tree/17.0/l10n_es_vat_prorate
     :alt: OCA/l10n-spain
 .. |badge4| image:: https://img.shields.io/badge/weblate-Translate%20me-F47D42.png
-    :target: https://translation.odoo-community.org/projects/l10n-spain-16-0/l10n-spain-16-0-l10n_es_vat_prorate
+    :target: https://translation.odoo-community.org/projects/l10n-spain-17-0/l10n-spain-17-0-l10n_es_vat_prorate
     :alt: Translate me on Weblate
 .. |badge5| image:: https://img.shields.io/badge/runboat-Try%20me-875A7B.png
-    :target: https://runboat.odoo-community.org/builds?repo=OCA/l10n-spain&target_branch=16.0
+    :target: https://runboat.odoo-community.org/builds?repo=OCA/l10n-spain&target_branch=17.0
     :alt: Try me on Runboat
 
 |badge1| |badge2| |badge3| |badge4| |badge5|
 
 El módulo nos divide los IVA según la prorrata de la compañía.
 
 **Table of contents**
 
 .. contents::
    :local:
 
 Configuration
 =============
 
-* Accede a la companía y marca que aplica prorrata
-* Define el porcentaje de prorata (se aplica por fechas)
+-  Accede a la companía y marca que aplica prorrata
+-  Define el porcentaje de prorrata (se aplica por fechas)
 
-Los impuestos de las facturas de cliente se dividiran según la prorata activa.
+Los impuestos de las facturas de proveedor se dividirán según la
+prorrata activa.
 
 Known issues / Roadmap
 ======================
 
-- No compatible con criterio de caja.
+-  No compatible con criterio de caja.
 
 Bug Tracker
 ===========
 
 Bugs are tracked on `GitHub Issues <https://github.com/OCA/l10n-spain/issues>`_.
 In case of trouble, please check there if your issue has already been reported.
 If you spotted it first, help us to smash it by providing a detailed and welcomed
-`feedback <https://github.com/OCA/l10n-spain/issues/new?body=module:%20l10n_es_vat_prorate%0Aversion:%2016.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.
+`feedback <https://github.com/OCA/l10n-spain/issues/new?body=module:%20l10n_es_vat_prorate%0Aversion:%2017.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.
 
 Do not contact contributors directly about support or help with technical issues.
 
 Credits
 =======
 
 Authors
-~~~~~~~
+-------
 
 * Creu Blanca
 * Tecnativa
 
 Contributors
-~~~~~~~~~~~~
+------------
 
-* Enric Tobella
-* `Tecnativa <https://www.tecnativa.com/>`_:
+-  Enric Tobella
+-  `Tecnativa <https://www.tecnativa.com/>`__:
 
-  * Pedro M. Baeza
-  * Carolina Fernandez
+   -  Pedro M. Baeza
+   -  Carolina Fernandez
+
+-  `Sygel <https://www.sygel.es/>`__:
+
+   -  Manuel Regidor
 
 Maintainers
-~~~~~~~~~~~
+-----------
 
 This module is maintained by the OCA.
 
 .. image:: https://odoo-community.org/logo.png
    :alt: Odoo Community Association
    :target: https://odoo-community.org
 
 OCA, or the Odoo Community Association, is a nonprofit organization whose
 mission is to support the collaborative development of Odoo features and
 promote its widespread use.
 
-This module is part of the `OCA/l10n-spain <https://github.com/OCA/l10n-spain/tree/16.0/l10n_es_vat_prorate>`_ project on GitHub.
+This module is part of the `OCA/l10n-spain <https://github.com/OCA/l10n-spain/tree/17.0/l10n_es_vat_prorate>`_ project on GitHub.
 
 You are welcome to contribute. To learn how please visit https://odoo-community.org/page/Contribute.
-
-
```

## Comparing `odoo_addon_l10n_es_vat_prorate-16.0.1.0.1.7.dist-info/RECORD` & `odoo_addon_l10n_es_vat_prorate-17.0.1.0.0.2.dist-info/RECORD`

 * *Files 6% similar despite different names*

```diff
@@ -1,28 +1,28 @@
-odoo/addons/l10n_es_vat_prorate/README.rst,sha256=ZY1ACmGvFe2bCWa1Go7EtXnq-Nn-p2hW--HO8yJMq3w,3199
+odoo/addons/l10n_es_vat_prorate/README.rst,sha256=b7nHU9wJQUqqJWwNZakO_qptVC04f7KhQVG8lB-yPek,3275
 odoo/addons/l10n_es_vat_prorate/__init__.py,sha256=X9EJGOE2GtZbS0G82PtSXmWSZ_R8jEM0rlJTDliQjp4,21
-odoo/addons/l10n_es_vat_prorate/__manifest__.py,sha256=72OgzWq8ElB-wwQSm7XDUGNgQXOtjJtEIHcNzvebioM,719
-odoo/addons/l10n_es_vat_prorate/data/account_template_tax.xml,sha256=C5GAM9C5U2LXti9pLyLso_2WVeV-Zmw5Kt0Oq8UATHQ,9925
+odoo/addons/l10n_es_vat_prorate/__manifest__.py,sha256=vA5tpi1D2UKHAGC0rHWfyfCPxlprz7ehhJJPZEVwThY,678
 odoo/addons/l10n_es_vat_prorate/i18n/ca.po,sha256=1AZ50dmrT8kPs9xmKC33Iq9WEFboQMsYAdV1-GjRJV4,5248
 odoo/addons/l10n_es_vat_prorate/i18n/es.po,sha256=xz60c-9XZc_2-kABeBPkkE4lCUbWzxYyeeNjbQ02_aI,5280
-odoo/addons/l10n_es_vat_prorate/i18n/l10n_es_vat_prorate.pot,sha256=JbjqUvS5F7jxR-LKzwSoitA1-Axpk_4pz-L8ZJJ880M,4571
-odoo/addons/l10n_es_vat_prorate/models/__init__.py,sha256=jIEdg7qeQkGuvMKmtfjCHXxaH9nJR6lLIGVJZdty8Mw,79
+odoo/addons/l10n_es_vat_prorate/i18n/l10n_es_vat_prorate.pot,sha256=Dc2wfZq1h6-GDgc96VWHoXfuJK7cBc-zwDLmTVcUhz8,3868
+odoo/addons/l10n_es_vat_prorate/models/__init__.py,sha256=jmi5sZnEaXNn8JDAV2I_2uUUUVp7a5U37F21I5P5Yig,107
 odoo/addons/l10n_es_vat_prorate/models/account_move.py,sha256=cjZ8pKvBHp7dfoHxcUeSd955_Ip6ar9eK62Tsf4m_pg,3026
-odoo/addons/l10n_es_vat_prorate/models/account_tax.py,sha256=tYRA3EyWuTH0YNWyOx1gba8wN-cRtzEtjU0hWOSMDGA,4160
-odoo/addons/l10n_es_vat_prorate/models/res_company.py,sha256=cibIdFCRubKporGP8zZyL9bZZRyY7Qt6z7w-oy3vez4,1547
-odoo/addons/l10n_es_vat_prorate/readme/CONFIGURE.rst,sha256=YobhDYZhrSHD-rmP6XTok-3LLQqLnHkNEyQjqq0kCCY,190
-odoo/addons/l10n_es_vat_prorate/readme/CONTRIBUTORS.rst,sha256=xn16sYfqpTuKB745wFTwW675xpUyy2Ct6cp-nG4825I,104
-odoo/addons/l10n_es_vat_prorate/readme/DESCRIPTION.rst,sha256=_v0xykyArhbS6i0C1KTCyg130if1w2rUtmqYIZKCSLY,67
-odoo/addons/l10n_es_vat_prorate/readme/ROADMAP.rst,sha256=-tQRRUrJ49WZS-IOov5BJ2XkJwAiJB7D_YWrpyMFSzk,38
+odoo/addons/l10n_es_vat_prorate/models/account_tax.py,sha256=9skFslQl1yml6cJ6OwztR-_P6Jy7SN1q33NK0CnXQ4M,1915
+odoo/addons/l10n_es_vat_prorate/models/prorate_taxes.py,sha256=AudFh-vBoZphg9DiTfkL0TeCYhdM2zxXsVpPQnV4RmQ,3214
+odoo/addons/l10n_es_vat_prorate/models/res_company.py,sha256=z0YvYVY6y_vxzeIaGZFcV3IlHs9YYF7175nypJ5XF_8,2383
+odoo/addons/l10n_es_vat_prorate/readme/CONFIGURE.md,sha256=QHmTVM7W573Y4WZqLY4j6ztKP44cDRN0LHzPhkxAeBI,195
+odoo/addons/l10n_es_vat_prorate/readme/CONTRIBUTORS.md,sha256=cQi00hKuQ9AovL_GiHJJMYAwtxk2LzbHIcp_pomXw_s,154
+odoo/addons/l10n_es_vat_prorate/readme/DESCRIPTION.md,sha256=_v0xykyArhbS6i0C1KTCyg130if1w2rUtmqYIZKCSLY,67
+odoo/addons/l10n_es_vat_prorate/readme/ROADMAP.md,sha256=-tQRRUrJ49WZS-IOov5BJ2XkJwAiJB7D_YWrpyMFSzk,38
 odoo/addons/l10n_es_vat_prorate/security/ir.model.access.csv,sha256=r6aMS29OP-UNeSm1n3VoKFIdsPzE1eSO6XTb2q4L5BY,311
 odoo/addons/l10n_es_vat_prorate/static/description/icon.png,sha256=6xBPJauaFOF0KDHfHgQopSc28kKvxMaeoQFQWZtfZDo,9455
-odoo/addons/l10n_es_vat_prorate/static/description/index.html,sha256=0IyBR24hM75fljHaSJ1wm5GYv84ZEZFCLy9_wOoxsKc,12874
+odoo/addons/l10n_es_vat_prorate/static/description/index.html,sha256=8Wtw-sFkfSi7mr8gRjR7qJFMy_qKNjPgVJrNs2-iUEg,12993
 odoo/addons/l10n_es_vat_prorate/tests/__init__.py,sha256=6Rb6Tok-1VPTnknpQ9zVcvvPDgK3on_2Ixg-B80jFC4,62
-odoo/addons/l10n_es_vat_prorate/tests/test_prorate_sii.py,sha256=QEIPHwZk1onXJx8GftIfOWLib9RtolrpB3rkYdIw7kA,4512
-odoo/addons/l10n_es_vat_prorate/tests/test_vat_prorate.py,sha256=RCG-CBxfTuJahaYB4ZA2ifNITkYlCaf8cp0rMS9l2AQ,7471
+odoo/addons/l10n_es_vat_prorate/tests/test_prorate_sii.py,sha256=jFDTvQ1bXcU8jRLKxe_pJEVBeGdBJA0WG_YWnngQVo8,4593
+odoo/addons/l10n_es_vat_prorate/tests/test_vat_prorate.py,sha256=kzG_kPnGITjxdpga-XtOmlPpRceIH3-1MB8dpsX3Aa8,8015
 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_invoice_p_iva0_ns_p_iva10_bc_dict.json,sha256=tCQFGnX__BpnvMswqGcDUNLlnCdV3QEXqfDtVMK65Zc,736
 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_invoice_p_iva10_bc_dict.json,sha256=vyg-awdYzAid2RC2YPx24MUfUdaUQcWhMlE9jFzTuzA,701
 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_invoice_p_iva10_bc_p_irpf19_p_iva21_sc_p_irpf19_dict.json,sha256=8MHejY63AInBIP7-iNqoWVkdY7ci2zpX82BcMQeGgRA,787
 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_invoice_p_iva10_bc_p_irpf1_dict.json,sha256=mDGqg-rrgUuRo1wl5iGQyZz9-ZCTT5y2q85wmTEgZCk,701
 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_invoice_p_iva10_bc_p_req014_p_iva21_sc_p_req52_dict.json,sha256=4dZqOUrY_gUdK-5ftUsZF9m0Lz1kajdhXfINr8KTkaE,1096
 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_invoice_p_iva21_sp_ex_dict.json,sha256=kUPHMdt_hHd0JEtgVaE4JhDT6sf1wWJ0jEsdCZD_5DE,710
 odoo/addons/l10n_es_vat_prorate/tests/json/sii_in_refund_p_iva10_bc_dict.json,sha256=SHkUkOX-V8B1jPaqHvmmWsgKV_R_vnh9hVrkKrIK5_0,734
@@ -34,14 +34,14 @@
 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_invoice_s_iva10b_s_iva21s_dict.json,sha256=pqNkawOZKTiJn5Y10DpzeMNEbnhwUd9j52bH6I5oPG8,1362
 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_invoice_s_iva10b_s_req014_s_iva21s_s_req52_dict.json,sha256=igz-GuiiXhC1Rf2wDx6zNs2JCOu6TuyXXsbbW1Hu5Mg,1573
 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_invoice_s_iva_e_s_iva0_e_dict.json,sha256=s8UxoW_JFc5RgDax4U_nFEvqYyQS83T6n9wwhe20Iwk,921
 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_refund_s_iva0_sp_i_s_iva0_ic_dict.json,sha256=qYdeuYjMUUR9tkf2YWUNzkuCmsEhtUJGWpw7tj6eYUA,956
 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_refund_s_iva10b_s_iva10b_s_iva21s_dict.json,sha256=gzI_xSSLdHz5qBll5rqJ9TJmHbxRCPl1e9WOqci7THU,1397
 odoo/addons/l10n_es_vat_prorate/tests/json/sii_out_refund_s_iva_e_s_iva0_e_dict.json,sha256=qYdeuYjMUUR9tkf2YWUNzkuCmsEhtUJGWpw7tj6eYUA,956
 odoo/addons/l10n_es_vat_prorate/views/account_move_views.xml,sha256=wjM_aoFSnnnOqPpptJfXwlibAWaoD5QpFYlNFZherCE,707
-odoo/addons/l10n_es_vat_prorate/views/account_tax_views.xml,sha256=xVLUeEYweW5vcEenIBETAsW-eImTVqjoLbonDx0xYy0,1017
+odoo/addons/l10n_es_vat_prorate/views/account_tax_views.xml,sha256=EFcmy7bsBJSVpevN_sTdWvX75dkKv1mKDXRNTsHXSkE,967
 odoo/addons/l10n_es_vat_prorate/views/res_company_prorate_views.xml,sha256=w2vOu7K0ichZwC7zJ7Vu2AWYjtxw0thaLs8fBQ7uEDE,1201
-odoo/addons/l10n_es_vat_prorate/views/res_company_views.xml,sha256=6UqcXtAhmiyOFNKMjlPp-iQS3_Fv8RS-kOuLOb0Lxww,949
-odoo_addon_l10n_es_vat_prorate-16.0.1.0.1.7.dist-info/METADATA,sha256=A2hcwLYkgW0pC-CVRdd7Ocd55glr2DntlBek0LSftew,3831
-odoo_addon_l10n_es_vat_prorate-16.0.1.0.1.7.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
-odoo_addon_l10n_es_vat_prorate-16.0.1.0.1.7.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo_addon_l10n_es_vat_prorate-16.0.1.0.1.7.dist-info/RECORD,,
+odoo/addons/l10n_es_vat_prorate/views/res_company_views.xml,sha256=5av5fMJXjThROUPBo-noxhBLsjDmcCYPXSwNiwcxN74,924
+odoo_addon_l10n_es_vat_prorate-17.0.1.0.0.2.dist-info/METADATA,sha256=df6t2bqB7CdJaMZ89HBm-1drOVpwmfjukjKGNwVgMdY,3905
+odoo_addon_l10n_es_vat_prorate-17.0.1.0.0.2.dist-info/WHEEL,sha256=8Rd4enx1PCuyDWP4SABqO5Fv8rpaknqp3VzjoFFLa6c,83
+odoo_addon_l10n_es_vat_prorate-17.0.1.0.0.2.dist-info/top_level.txt,sha256=QE6RBQ0QX5f4eFuUcGgU5Kbq1A_qJcDs-e_vpr6pmfU,4
+odoo_addon_l10n_es_vat_prorate-17.0.1.0.0.2.dist-info/RECORD,,
```

