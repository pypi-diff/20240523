# Comparing `tmp/berryworld-1.0.0.98128-py3-none-any.whl.zip` & `tmp/berryworld-1.0.0.99947-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,29 +1,29 @@
-Zip file size: 35367 bytes, number of entries: 27
--rw-r--r--  2.0 unx      422 b- defN 22-Jan-31 12:08 berryworld/__init__.py
--rw-r--r--  2.0 unx     8487 b- defN 22-Jan-31 12:08 berryworld/allocation_solver.py
--rw-r--r--  2.0 unx     1672 b- defN 22-Jan-31 12:08 berryworld/application_logs.py
--rw-r--r--  2.0 unx     4565 b- defN 22-Jan-31 12:08 berryworld/blob_storage.py
--rw-r--r--  2.0 unx     2242 b- defN 22-Jan-31 12:08 berryworld/cache_data.py
--rw-r--r--  2.0 unx      558 b- defN 22-Jan-31 12:08 berryworld/config_loader.py
--rw-r--r--  2.0 unx     3378 b- defN 22-Jan-31 12:08 berryworld/email_logging.py
--rw-r--r--  2.0 unx    12640 b- defN 22-Jan-31 12:08 berryworld/email_tool.py
--rw-r--r--  2.0 unx     1590 b- defN 22-Jan-31 12:08 berryworld/getdate.py
--rw-r--r--  2.0 unx     8969 b- defN 22-Jan-31 12:08 berryworld/handy_mix.py
--rw-r--r--  2.0 unx     2381 b- defN 22-Jan-31 12:08 berryworld/pickle_management.py
--rw-r--r--  2.0 unx     6981 b- defN 22-Jan-31 12:08 berryworld/postgres_connection.py
--rw-r--r--  2.0 unx    14557 b- defN 22-Jan-31 12:08 berryworld/sharepoint.py
--rw-r--r--  2.0 unx    33043 b- defN 22-Jan-31 12:08 berryworld/sql_connection.py
--rw-r--r--  2.0 unx     4775 b- defN 22-Jan-31 12:08 berryworld/transportation_solver.py
--rw-r--r--  2.0 unx      957 b- defN 22-Jan-31 12:08 berryworld/xml_parser.py
--rw-r--r--  2.0 unx        0 b- defN 22-Jan-31 12:08 tests/__init__.py
--rw-r--r--  2.0 unx     4469 b- defN 22-Jan-31 12:08 tests/test_allocation_config.py
--rw-r--r--  2.0 unx      454 b- defN 22-Jan-31 12:08 tests/test_config_loader.py
--rw-r--r--  2.0 unx     1392 b- defN 22-Jan-31 12:08 tests/test_get_date_config.py
--rw-r--r--  2.0 unx     2594 b- defN 22-Jan-31 12:08 tests/test_handy_mix_config.py
--rw-r--r--  2.0 unx      859 b- defN 22-Jan-31 12:08 tests/test_xml_parser.py
--rw-r--r--  2.0 unx     1089 b- defN 22-Jan-31 12:08 berryworld-1.0.0.98128.dist-info/LICENSE
--rw-r--r--  2.0 unx     1113 b- defN 22-Jan-31 12:08 berryworld-1.0.0.98128.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 22-Jan-31 12:08 berryworld-1.0.0.98128.dist-info/WHEEL
--rw-r--r--  2.0 unx       17 b- defN 22-Jan-31 12:08 berryworld-1.0.0.98128.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2268 b- defN 22-Jan-31 12:08 berryworld-1.0.0.98128.dist-info/RECORD
-27 files, 121564 bytes uncompressed, 31709 bytes compressed:  73.9%
+Zip file size: 35430 bytes, number of entries: 27
+-rw-r--r--  2.0 unx      422 b- defN 22-Feb-15 13:45 berryworld/__init__.py
+-rw-r--r--  2.0 unx     8487 b- defN 22-Feb-15 13:45 berryworld/allocation_solver.py
+-rw-r--r--  2.0 unx     1672 b- defN 22-Feb-15 13:45 berryworld/application_logs.py
+-rw-r--r--  2.0 unx     4565 b- defN 22-Feb-15 13:45 berryworld/blob_storage.py
+-rw-r--r--  2.0 unx     2242 b- defN 22-Feb-15 13:45 berryworld/cache_data.py
+-rw-r--r--  2.0 unx      558 b- defN 22-Feb-15 13:45 berryworld/config_loader.py
+-rw-r--r--  2.0 unx     3460 b- defN 22-Feb-15 13:45 berryworld/email_logging.py
+-rw-r--r--  2.0 unx    12640 b- defN 22-Feb-15 13:45 berryworld/email_tool.py
+-rw-r--r--  2.0 unx     1590 b- defN 22-Feb-15 13:45 berryworld/getdate.py
+-rw-r--r--  2.0 unx     8969 b- defN 22-Feb-15 13:45 berryworld/handy_mix.py
+-rw-r--r--  2.0 unx     2381 b- defN 22-Feb-15 13:45 berryworld/pickle_management.py
+-rw-r--r--  2.0 unx     6981 b- defN 22-Feb-15 13:45 berryworld/postgres_connection.py
+-rw-r--r--  2.0 unx    14557 b- defN 22-Feb-15 13:45 berryworld/sharepoint.py
+-rw-r--r--  2.0 unx    33043 b- defN 22-Feb-15 13:45 berryworld/sql_connection.py
+-rw-r--r--  2.0 unx     4775 b- defN 22-Feb-15 13:45 berryworld/transportation_solver.py
+-rw-r--r--  2.0 unx      957 b- defN 22-Feb-15 13:45 berryworld/xml_parser.py
+-rw-r--r--  2.0 unx        0 b- defN 22-Feb-15 13:45 tests/__init__.py
+-rw-r--r--  2.0 unx     4469 b- defN 22-Feb-15 13:45 tests/test_allocation_config.py
+-rw-r--r--  2.0 unx      454 b- defN 22-Feb-15 13:45 tests/test_config_loader.py
+-rw-r--r--  2.0 unx     1392 b- defN 22-Feb-15 13:45 tests/test_get_date_config.py
+-rw-r--r--  2.0 unx     2594 b- defN 22-Feb-15 13:45 tests/test_handy_mix_config.py
+-rw-r--r--  2.0 unx      859 b- defN 22-Feb-15 13:45 tests/test_xml_parser.py
+-rw-r--r--  2.0 unx     1089 b- defN 22-Feb-15 13:45 berryworld-1.0.0.99947.dist-info/LICENSE
+-rw-r--r--  2.0 unx     1113 b- defN 22-Feb-15 13:45 berryworld-1.0.0.99947.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 22-Feb-15 13:45 berryworld-1.0.0.99947.dist-info/WHEEL
+-rw-r--r--  2.0 unx       17 b- defN 22-Feb-15 13:45 berryworld-1.0.0.99947.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     2268 b- defN 22-Feb-15 13:45 berryworld-1.0.0.99947.dist-info/RECORD
+27 files, 121646 bytes uncompressed, 31772 bytes compressed:  73.9%
```

## zipnote {}

```diff
@@ -60,23 +60,23 @@
 
 Filename: tests/test_handy_mix_config.py
 Comment: 
 
 Filename: tests/test_xml_parser.py
 Comment: 
 
-Filename: berryworld-1.0.0.98128.dist-info/LICENSE
+Filename: berryworld-1.0.0.99947.dist-info/LICENSE
 Comment: 
 
-Filename: berryworld-1.0.0.98128.dist-info/METADATA
+Filename: berryworld-1.0.0.99947.dist-info/METADATA
 Comment: 
 
-Filename: berryworld-1.0.0.98128.dist-info/WHEEL
+Filename: berryworld-1.0.0.99947.dist-info/WHEEL
 Comment: 
 
-Filename: berryworld-1.0.0.98128.dist-info/top_level.txt
+Filename: berryworld-1.0.0.99947.dist-info/top_level.txt
 Comment: 
 
-Filename: berryworld-1.0.0.98128.dist-info/RECORD
+Filename: berryworld-1.0.0.99947.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## berryworld/email_logging.py

```diff
@@ -18,51 +18,51 @@
         :param timeout: Time in seconds after which an unsuccessful log will be sent
         :param print_sql: Print the SQL statement sent to the server
         """
         self.log_df = pd.DataFrame({'ProjectName': [project_name], 'Pipeline': [pipeline],
                                     'Successful': [0], 'IPAddress': [str(ip_address).replace("'", '"')],
                                     'RequestUrl': [str(request_url).replace("'", '"')], 'Sent': [0],
                                     'StartedDate': [datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S.%f")]})
-        self.id_list = list()
         self.sql_con = sql_con
         self.timeout = timeout
-        self.exit_event = False
         self.print_sql = print_sql
+        self.failure_type = []
         Thread(target=self.start_threading).start()
 
     def start_threading(self):
         """ Start a threading to update on failure if the script breaks or the pipeline gets blocked
         """
         time_range = math.ceil(self.timeout / 10)
         for times in range(time_range):
             time.sleep(10)
-            if self.exit_event:
+            if len(self.failure_type) > 0:
                 break
 
-        if len(self.id_list) == 0:
+        if len(self.failure_type) == 0:
+            elapsed_time = str(datetime.timedelta(seconds=round(self.timeout)))[2:]
             self.on_failure(error_message=f'The pipeline failed to succeed after running '
-                                          f'for {self.timeout/60:.2f} minutes')
+                                          f'for {elapsed_time} minutes')
 
-    def on_successful(self):
+    def on_success(self):
         """ Update log on success
         """
-        if len(self.id_list) == 0:
+        if not any(self.failure_type):
             successful_columns = {'Successful': 1,
                                   'FinishedDate': datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S.%f")}
             self.log_df = self.log_df.assign(**successful_columns)
-            self.id_list.append(self.sql_con.insert(self.log_df, 'ETL', 'PythonEmailLogs', output=['Id'],
-                                                    print_sql=self.print_sql))
-            self.exit_event = True
+            self.sql_con.insert(self.log_df, 'ETL', 'PythonEmailLogs', print_sql=self.print_sql)
+            self.failure_type.append(True)
 
-    def on_failure(self, error_message, section=None):
+    def on_failure(self, error_message, section=None, critical=True):
         """ Update log on failure
         :param error_message: Error message to be sent in the Log
         :param section: Indicate the script section. Useful to locate the error
+        :param critical: Indicate whether it should avoid sending successful logs
         """
         unsuccessful_columns = {'Successful': 0,
                                 'FinishedDate': datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S.%f"),
                                 'Section': section,
-                                'ErrorMessage': str(error_message).replace("'", '"')}
+                                'ErrorMessage': str(error_message).replace("'", '"'),
+                                'Critical': 1 if critical is True else 0}
         self.log_df = self.log_df.assign(**unsuccessful_columns)
-        self.id_list.append(self.sql_con.insert(self.log_df, 'ETL', 'PythonEmailLogs', output=['Id'],
-                                                print_sql=self.print_sql))
-        self.exit_event = True
+        self.sql_con.insert(self.log_df, 'ETL', 'PythonEmailLogs', print_sql=self.print_sql)
+        self.failure_type.append(critical)
```

## Comparing `berryworld-1.0.0.98128.dist-info/LICENSE` & `berryworld-1.0.0.99947.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `berryworld-1.0.0.98128.dist-info/METADATA` & `berryworld-1.0.0.99947.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: berryworld
-Version: 1.0.0.98128
+Version: 1.0.0.99947
 Summary: Handy classes to improve ETL processes
 Home-page: https://www.berryworld.com
 Author: BerryWorld ltd
 Author-email: data@berryworld.com
 License: UNKNOWN
 Platform: UNKNOWN
 Classifier: Programming Language :: Python :: 3
```

## Comparing `berryworld-1.0.0.98128.dist-info/RECORD` & `berryworld-1.0.0.99947.dist-info/RECORD`

 * *Files 14% similar despite different names*

```diff
@@ -1,14 +1,14 @@
 berryworld/__init__.py,sha256=QkKbSliwsxlSk0X2-gVDpf-D6sdGdNA59F2Jb9cLMrE,422
 berryworld/allocation_solver.py,sha256=HuxL5tJFmMrCrfUrU71OCcujtARtXDT3plU-EMeVYDY,8487
 berryworld/application_logs.py,sha256=FMPRjLMA0N3miZVsj_BH8h1ZhioM0QXpVVbK8VqrQpU,1672
 berryworld/blob_storage.py,sha256=3eS9WjPDUkAySbwmUr5JfEp_w0e6fOz1kxiSWZysGXY,4565
 berryworld/cache_data.py,sha256=2cStWbFQHimon_lHMbcM_0vU7lt-FCge96D-T9YXaxQ,2242
 berryworld/config_loader.py,sha256=UECNAJoHHgjIH2epJfykh1R6aqbk6OyvNYmhBTswqJo,558
-berryworld/email_logging.py,sha256=rDzJ7z6MDkyGWPezv4XkNptCIbwBsrpK0Z_ieAtjWQc,3378
+berryworld/email_logging.py,sha256=22aN-1nvEcFkRxDIpdrArjFgjudNPGkPrT8Vk5YtzH0,3460
 berryworld/email_tool.py,sha256=pQrOr2qKPxriDTm_UKp94BFFHhfgsUAyFgNZoj__tII,12640
 berryworld/getdate.py,sha256=Dr4smrIjOKq_0KlKkriou67Ex-9Y0qNXD6Peom7FFpg,1590
 berryworld/handy_mix.py,sha256=uMHowje8j_UHKQGg4QVURWD6iJpaBgLzxSRkZQKrf-I,8969
 berryworld/pickle_management.py,sha256=C0qJEQch2SycUbLzVxC2ZZeWqrzjPhM0c0PqUOcLfvs,2381
 berryworld/postgres_connection.py,sha256=R3EFDBVNwIf0Me80RDs92NVtq-FX-KHZwZNJpqxAew4,6981
 berryworld/sharepoint.py,sha256=vW02tUiV62W642ayxjGWvJRTtl8oK8wGAQKVGiemkcM,14557
 berryworld/sql_connection.py,sha256=bEL10X809wS_nqFQyGu2GYr4kt6WqGqD17HNG7QbYJo,33043
@@ -16,12 +16,12 @@
 berryworld/xml_parser.py,sha256=HWD71NaTN3DaIOGT6Wzxs4CEsroFhGQwe9iPLIL80Co,957
 tests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 tests/test_allocation_config.py,sha256=8wOqHiab4KIJ4WkkIAit5ydJ0quBtOM4uCE2cWz825U,4469
 tests/test_config_loader.py,sha256=TmAfbUk6ag59nlqo5AbXzhc2b_5QTbVnX5Bmz3uimws,454
 tests/test_get_date_config.py,sha256=NkMoAVyM2o-yHgx8_mjsQ61fdlYn_Er1ACoUIOyzM4I,1392
 tests/test_handy_mix_config.py,sha256=Un56mz9KJmdn4K4OwzHAHLSRzDU1Xv2nFrONNuzOG04,2594
 tests/test_xml_parser.py,sha256=3QTlhFEd6KbK6nRFKZnc35tad6wqukTbe4QrFi8mr_8,859
-berryworld-1.0.0.98128.dist-info/LICENSE,sha256=w8Kbiwy4NFzLX84wENQC-hwDSBSxw8ub4I8ZojeTL_w,1089
-berryworld-1.0.0.98128.dist-info/METADATA,sha256=SGUzfkhPNQA9fu6pgVR45s0XZwHult68V2o3cO1V0w8,1113
-berryworld-1.0.0.98128.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-berryworld-1.0.0.98128.dist-info/top_level.txt,sha256=GIZ5qy-P5oxfEH755vA1IMFeTVdX3-40JxMe6nOe5I8,17
-berryworld-1.0.0.98128.dist-info/RECORD,,
+berryworld-1.0.0.99947.dist-info/LICENSE,sha256=w8Kbiwy4NFzLX84wENQC-hwDSBSxw8ub4I8ZojeTL_w,1089
+berryworld-1.0.0.99947.dist-info/METADATA,sha256=Q1OWd365zg4X4bpJBKD3nyKID3d0RSxX6RESO4n5GGo,1113
+berryworld-1.0.0.99947.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
+berryworld-1.0.0.99947.dist-info/top_level.txt,sha256=GIZ5qy-P5oxfEH755vA1IMFeTVdX3-40JxMe6nOe5I8,17
+berryworld-1.0.0.99947.dist-info/RECORD,,
```

