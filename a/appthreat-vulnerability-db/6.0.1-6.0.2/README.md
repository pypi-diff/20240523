# Comparing `tmp/appthreat-vulnerability-db-6.0.1.tar.gz` & `tmp/appthreat_vulnerability_db-6.0.2.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "appthreat-vulnerability-db-6.0.1.tar", last modified: Fri Apr  5 15:19:20 2024, max compression
+gzip compressed data, was "appthreat_vulnerability_db-6.0.2.tar", last modified: Sun Apr 21 12:24:55 2024, max compression
```

## Comparing `appthreat-vulnerability-db-6.0.1.tar` & `appthreat_vulnerability_db-6.0.2.tar`

### file list

```diff
@@ -1,40 +1,40 @@
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-05 15:19:20.023753 appthreat-vulnerability-db-6.0.1/
--rw-r--r--   0 runner    (1001) docker     (127)     1066 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/LICENSE
--rw-r--r--   0 runner    (1001) docker     (127)     7463 2024-04-05 15:19:20.023753 appthreat-vulnerability-db-6.0.1/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (127)     5930 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/README.md
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-05 15:19:20.019753 appthreat-vulnerability-db-6.0.1/appthreat_vulnerability_db.egg-info/
--rw-r--r--   0 runner    (1001) docker     (127)     7463 2024-04-05 15:19:19.000000 appthreat-vulnerability-db-6.0.1/appthreat_vulnerability_db.egg-info/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (127)      777 2024-04-05 15:19:20.000000 appthreat-vulnerability-db-6.0.1/appthreat_vulnerability_db.egg-info/SOURCES.txt
--rw-r--r--   0 runner    (1001) docker     (127)        1 2024-04-05 15:19:19.000000 appthreat-vulnerability-db-6.0.1/appthreat_vulnerability_db.egg-info/dependency_links.txt
--rw-r--r--   0 runner    (1001) docker     (127)       37 2024-04-05 15:19:19.000000 appthreat-vulnerability-db-6.0.1/appthreat_vulnerability_db.egg-info/entry_points.txt
--rw-r--r--   0 runner    (1001) docker     (127)      178 2024-04-05 15:19:20.000000 appthreat-vulnerability-db-6.0.1/appthreat_vulnerability_db.egg-info/requires.txt
--rw-r--r--   0 runner    (1001) docker     (127)        4 2024-04-05 15:19:20.000000 appthreat-vulnerability-db-6.0.1/appthreat_vulnerability_db.egg-info/top_level.txt
--rw-r--r--   0 runner    (1001) docker     (127)     1899 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/pyproject.toml
--rw-r--r--   0 runner    (1001) docker     (127)       38 2024-04-05 15:19:20.023753 appthreat-vulnerability-db-6.0.1/setup.cfg
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-05 15:19:20.015753 appthreat-vulnerability-db-6.0.1/test/
--rw-r--r--   0 runner    (1001) docker     (127)     3418 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/test/test_npm.py
--rw-r--r--   0 runner    (1001) docker     (127)    35920 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/test/test_source.py
--rw-r--r--   0 runner    (1001) docker     (127)    35361 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/test/test_utils.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-05 15:19:20.015753 appthreat-vulnerability-db-6.0.1/vdb/
--rw-r--r--   0 runner    (1001) docker     (127)        0 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/vdb/__init__.py
--rw-r--r--   0 runner    (1001) docker     (127)     6911 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/vdb/cli.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-05 15:19:20.019753 appthreat-vulnerability-db-6.0.1/vdb/lib/
--rw-r--r--   0 runner    (1001) docker     (127)    21523 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/vdb/lib/__init__.py
--rw-r--r--   0 runner    (1001) docker     (127)    42495 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/vdb/lib/aqua.py
--rw-r--r--   0 runner    (1001) docker     (127)    18502 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/vdb/lib/cna.py
--rw-r--r--   0 runner    (1001) docker     (127)     7437 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/vdb/lib/config.py
--rw-r--r--   0 runner    (1001) docker     (127)    18006 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/vdb/lib/cve.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-05 15:19:20.019753 appthreat-vulnerability-db-6.0.1/vdb/lib/cve_model/
--rw-r--r--   0 runner    (1001) docker     (127)    49819 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/vdb/lib/cve_model/__init__.py
--rw-r--r--   0 runner    (1001) docker     (127)     3696 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/vdb/lib/cve_model/common.py
--rw-r--r--   0 runner    (1001) docker     (127)     2061 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/vdb/lib/cve_model/cvss_v2.py
--rw-r--r--   0 runner    (1001) docker     (127)     5124 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/vdb/lib/cve_model/cvss_v3.py
--rw-r--r--   0 runner    (1001) docker     (127)     3752 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/vdb/lib/cve_model/tagger.py
--rw-r--r--   0 runner    (1001) docker     (127)     3429 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/vdb/lib/db6.py
--rwxr-xr-x   0 runner    (1001) docker     (127)    11371 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/vdb/lib/gha.py
--rw-r--r--   0 runner    (1001) docker     (127)    11095 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/vdb/lib/npm.py
--rw-r--r--   0 runner    (1001) docker     (127)    17747 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/vdb/lib/nvd.py
--rw-r--r--   0 runner    (1001) docker     (127)     1881 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/vdb/lib/orasclient.py
--rw-r--r--   0 runner    (1001) docker     (127)    19592 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/vdb/lib/osv.py
--rw-r--r--   0 runner    (1001) docker     (127)     6745 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/vdb/lib/search.py
--rw-r--r--   0 runner    (1001) docker     (127)    40016 2024-04-05 15:19:11.000000 appthreat-vulnerability-db-6.0.1/vdb/lib/utils.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-21 12:24:55.464988 appthreat_vulnerability_db-6.0.2/
+-rw-r--r--   0 runner    (1001) docker     (127)     1066 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/LICENSE
+-rw-r--r--   0 runner    (1001) docker     (127)     7463 2024-04-21 12:24:55.464988 appthreat_vulnerability_db-6.0.2/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (127)     5930 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/README.md
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-21 12:24:55.464988 appthreat_vulnerability_db-6.0.2/appthreat_vulnerability_db.egg-info/
+-rw-r--r--   0 runner    (1001) docker     (127)     7463 2024-04-21 12:24:55.000000 appthreat_vulnerability_db-6.0.2/appthreat_vulnerability_db.egg-info/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (127)      777 2024-04-21 12:24:55.000000 appthreat_vulnerability_db-6.0.2/appthreat_vulnerability_db.egg-info/SOURCES.txt
+-rw-r--r--   0 runner    (1001) docker     (127)        1 2024-04-21 12:24:55.000000 appthreat_vulnerability_db-6.0.2/appthreat_vulnerability_db.egg-info/dependency_links.txt
+-rw-r--r--   0 runner    (1001) docker     (127)       37 2024-04-21 12:24:55.000000 appthreat_vulnerability_db-6.0.2/appthreat_vulnerability_db.egg-info/entry_points.txt
+-rw-r--r--   0 runner    (1001) docker     (127)      178 2024-04-21 12:24:55.000000 appthreat_vulnerability_db-6.0.2/appthreat_vulnerability_db.egg-info/requires.txt
+-rw-r--r--   0 runner    (1001) docker     (127)        4 2024-04-21 12:24:55.000000 appthreat_vulnerability_db-6.0.2/appthreat_vulnerability_db.egg-info/top_level.txt
+-rw-r--r--   0 runner    (1001) docker     (127)     1899 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/pyproject.toml
+-rw-r--r--   0 runner    (1001) docker     (127)       38 2024-04-21 12:24:55.464988 appthreat_vulnerability_db-6.0.2/setup.cfg
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-21 12:24:55.460988 appthreat_vulnerability_db-6.0.2/test/
+-rw-r--r--   0 runner    (1001) docker     (127)     3418 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/test/test_npm.py
+-rw-r--r--   0 runner    (1001) docker     (127)    36706 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/test/test_source.py
+-rw-r--r--   0 runner    (1001) docker     (127)    36092 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/test/test_utils.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-21 12:24:55.460988 appthreat_vulnerability_db-6.0.2/vdb/
+-rw-r--r--   0 runner    (1001) docker     (127)        0 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/vdb/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (127)     6911 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/vdb/cli.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-21 12:24:55.460988 appthreat_vulnerability_db-6.0.2/vdb/lib/
+-rw-r--r--   0 runner    (1001) docker     (127)    21523 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/vdb/lib/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (127)    42493 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/vdb/lib/aqua.py
+-rw-r--r--   0 runner    (1001) docker     (127)    18502 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/vdb/lib/cna.py
+-rw-r--r--   0 runner    (1001) docker     (127)     7437 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/vdb/lib/config.py
+-rw-r--r--   0 runner    (1001) docker     (127)    18006 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/vdb/lib/cve.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-21 12:24:55.464988 appthreat_vulnerability_db-6.0.2/vdb/lib/cve_model/
+-rw-r--r--   0 runner    (1001) docker     (127)    49819 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/vdb/lib/cve_model/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (127)     3696 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/vdb/lib/cve_model/common.py
+-rw-r--r--   0 runner    (1001) docker     (127)     2061 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/vdb/lib/cve_model/cvss_v2.py
+-rw-r--r--   0 runner    (1001) docker     (127)     5124 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/vdb/lib/cve_model/cvss_v3.py
+-rw-r--r--   0 runner    (1001) docker     (127)     3752 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/vdb/lib/cve_model/tagger.py
+-rw-r--r--   0 runner    (1001) docker     (127)     3667 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/vdb/lib/db6.py
+-rwxr-xr-x   0 runner    (1001) docker     (127)    11371 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/vdb/lib/gha.py
+-rw-r--r--   0 runner    (1001) docker     (127)    11095 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/vdb/lib/npm.py
+-rw-r--r--   0 runner    (1001) docker     (127)    17747 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/vdb/lib/nvd.py
+-rw-r--r--   0 runner    (1001) docker     (127)     1881 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/vdb/lib/orasclient.py
+-rw-r--r--   0 runner    (1001) docker     (127)    19592 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/vdb/lib/osv.py
+-rw-r--r--   0 runner    (1001) docker     (127)     6745 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/vdb/lib/search.py
+-rw-r--r--   0 runner    (1001) docker     (127)    39962 2024-04-21 12:24:45.000000 appthreat_vulnerability_db-6.0.2/vdb/lib/utils.py
```

### Comparing `appthreat-vulnerability-db-6.0.1/LICENSE` & `appthreat_vulnerability_db-6.0.2/LICENSE`

 * *Files identical despite different names*

### Comparing `appthreat-vulnerability-db-6.0.1/PKG-INFO` & `appthreat_vulnerability_db-6.0.2/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: appthreat-vulnerability-db
-Version: 6.0.1
+Version: 6.0.2
 Summary: AppThreat's vulnerability database and package search library with a built-in sqlite based storage. OSV, CVE, GitHub, npm are the primary sources of vulnerabilities.
 Author-email: Team AppThreat <cloud@appthreat.com>
 License: MIT
 Project-URL: Homepage, https://github.com/appthreat/vulnerability-db
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
 Classifier: Intended Audience :: System Administrators
```

### Comparing `appthreat-vulnerability-db-6.0.1/README.md` & `appthreat_vulnerability_db-6.0.2/README.md`

 * *Files identical despite different names*

### Comparing `appthreat-vulnerability-db-6.0.1/appthreat_vulnerability_db.egg-info/PKG-INFO` & `appthreat_vulnerability_db-6.0.2/appthreat_vulnerability_db.egg-info/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: appthreat-vulnerability-db
-Version: 6.0.1
+Version: 6.0.2
 Summary: AppThreat's vulnerability database and package search library with a built-in sqlite based storage. OSV, CVE, GitHub, npm are the primary sources of vulnerabilities.
 Author-email: Team AppThreat <cloud@appthreat.com>
 License: MIT
 Project-URL: Homepage, https://github.com/appthreat/vulnerability-db
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
 Classifier: Intended Audience :: System Administrators
```

### Comparing `appthreat-vulnerability-db-6.0.1/appthreat_vulnerability_db.egg-info/SOURCES.txt` & `appthreat_vulnerability_db-6.0.2/appthreat_vulnerability_db.egg-info/SOURCES.txt`

 * *Files identical despite different names*

### Comparing `appthreat-vulnerability-db-6.0.1/pyproject.toml` & `appthreat_vulnerability_db-6.0.2/pyproject.toml`

 * *Files 15% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 [project]
 name = "appthreat-vulnerability-db"
-version = "6.0.1"
+version = "6.0.2"
 description = "AppThreat's vulnerability database and package search library with a built-in sqlite based storage. OSV, CVE, GitHub, npm are the primary sources of vulnerabilities."
 authors = [
     {name = "Team AppThreat", email = "cloud@appthreat.com"},
 ]
 dependencies = [
     "httpx[http2]",
     "appdirs",
```

### Comparing `appthreat-vulnerability-db-6.0.1/test/test_npm.py` & `appthreat_vulnerability_db-6.0.2/test/test_npm.py`

 * *Files identical despite different names*

### Comparing `appthreat-vulnerability-db-6.0.1/test/test_source.py` & `appthreat_vulnerability_db-6.0.2/test/test_source.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,19 +1,26 @@
 import json
 import os
 
 import pytest
+import tempfile
+import shutil
 
 from vdb.lib import VulnerabilityLocation, db6, search
 from vdb.lib.aqua import AquaSource
 from vdb.lib.cve import CVESource
 from vdb.lib.gha import GitHubSource
 from vdb.lib.nvd import NvdSource
 from vdb.lib.osv import OSVSource
 
+# Temp directories were not working on macOS GitHub runners
+test_tmp_dir = os.getenv("TEST_VDB_HOME", tempfile.mkdtemp(prefix="vdb6-tests-"))
+os.makedirs(test_tmp_dir, exist_ok=True)
+db6.get(os.path.join(test_tmp_dir, "data.vdb6"), os.path.join(test_tmp_dir, "index.vdb6"))
+
 
 @pytest.fixture
 def test_cve_json():
     test_cve_data = os.path.join(
         os.path.dirname(os.path.realpath(__file__)), "data", "cve_data.json"
     )
     with open(test_cve_data, "r") as fp:
@@ -161,14 +168,23 @@
         os.path.dirname(os.path.realpath(__file__)), "data", "osv-git.json"
     )
     with open(test_cve_data, "r") as fp:
         return json.loads(fp.read())
 
 
 @pytest.fixture
+def test_osv_npm_star_json():
+    test_cve_data = os.path.join(
+        os.path.dirname(os.path.realpath(__file__)), "data", "osv-npm-star-bug.json"
+    )
+    with open(test_cve_data, "r") as fp:
+        return json.loads(fp.read())
+
+
+@pytest.fixture
 def test_aqua_alsa_json():
     test_cve_data = os.path.join(
         os.path.dirname(os.path.realpath(__file__)), "data", "ALSA-2022-8580.json"
     )
     with open(test_cve_data, "r") as fp:
         return json.loads(fp.read())
 
@@ -791,14 +807,22 @@
     assert results_count == 1
 
     # pypi2
     cve_data = osvlatest.convert(test_osv_pypi2_json)
     assert not cve_data
 
 
+def test_osv_convert2(test_osv_npm_star_json):
+    osvlatest = OSVSource()
+
+    # npm star
+    cve_data = osvlatest.convert(test_osv_npm_star_json)
+    assert len(cve_data) == 3
+
+
 def test_aqua_convert(
     test_aqua_alsa_json,
     test_aqua_alas_json,
     test_aqua_rlsa_json,
     test_aqua_ubuntu_json,
     test_aqua_ubuntu1_json,
     test_aqua_ubuntu2_json,
@@ -866,15 +890,15 @@
     aqualatest.store(cve_data)
     cve_data_count, cve_index_count = db6.stats()
     assert cve_data_count == 27
     assert cve_index_count == 27
     results_count = len(list(search.search_by_any("CVE-2020-8022")))
     assert results_count == 0
     results_count = len(list(search.search_by_any("CVE-2022-45406")))
-    assert results_count == 27
+    assert results_count == 26
 
     # ubuntu1
     cve_data = aqualatest.convert(test_aqua_ubuntu1_json)
     assert cve_data
     assert len(cve_data) == 8
 
     db6.clear_all()
@@ -1183,7 +1207,10 @@
         "cpe:2.3:a:org.springframework:spring-web:*:*:*:*:*:*:*:*",
         "5.0.0.RC2",
         "*",
         "",
         "5.0.0.RC3",
     )
     assert vl.version == ">=5.0.0.RC2-<5.0.0.RC3"
+
+
+shutil.rmtree(test_tmp_dir, ignore_errors=True)
```

### Comparing `appthreat-vulnerability-db-6.0.1/test/test_utils.py` & `appthreat_vulnerability_db-6.0.2/test/test_utils.py`

 * *Files 1% similar despite different names*

```diff
@@ -129,14 +129,18 @@
     assert res
     res = utils.version_compare("1.0.3", "0", "*", None, None)
     assert res
     res = utils.version_compare("1.0.3", "1.4.1", "*", None, None)
     assert not res
     res = utils.version_compare("12.1.0.2.0", "*", "12.1.0.2", None, None)
     assert res
+    res = utils.version_compare("7.24.1", "0.0.0", None, None, "7.23.2")
+    assert not res
+    res = utils.version_compare("7.24.1", "8.0.0-alpha.0", None, None, "8.0.0-alpha.4")
+    assert not res
 
 
 def test_version_compare_go():
     res = utils.version_compare("v1.1.1", "v1.1.0", "v1.1.2")
     assert res
     res = utils.version_compare("v1.1.3", "v1.1.0", "v1.1.2")
     assert not res
@@ -225,14 +229,18 @@
     assert sver
     res = utils.version_compare("2.1.5.1-r3", "1.2.1-r0", "2.1.5.1-r1")
     assert not res
     res = utils.version_compare("2.1.5.1-r3", "2.1.5.1-r2", "2.1.5.1-r6")
     assert res
     res = utils.version_compare("2.1.5.1-rc3", "2.1.5.1-rc2", "2.1.5.1-rc6")
     assert res
+    res = utils.version_compare("7.24.1", "0.0.0", "7.23.2")
+    assert not res
+    res = utils.version_compare("7.24.1", "8.0.0-alpha.0", "8.0.0-alpha.4")
+    assert not res
 
 
 def test_version_build_diff_compare():
     res = utils.version_compare("7.0.0", "*", "*", None, "2020-04-23t00-58-49z")
     assert not res
     res = utils.version_compare("7.0.0", "*", "*", None, "2018-05-16t23-35-33z")
     assert not res
@@ -980,7 +988,15 @@
         "type": "generic",
         "namespace": "git.kernel.org/linux",
         "name": "kernel",
         "version": "0fa3ecd87848c9c93c2c828ef4c3a8ca36ce46c7",
         "qualifiers": None,
         "subpath": None,
     }
+
+
+def test_vers_compare():
+    assert not utils.vers_compare('7.24.1', 'vers:npm/<7.23.2')
+    assert utils.vers_compare("1.12", "vers:rpm/<=1.12.8-24.el8_8.1")
+    assert not utils.vers_compare("1.13.0", "vers:rpm/<=1.12.8-24.el8_8.1")
+    assert utils.vers_compare("5.5", "vers:deb/<5.6~rc2")
+    assert not utils.vers_compare("5.7", "vers:deb/<5.6~rc2")
```

### Comparing `appthreat-vulnerability-db-6.0.1/vdb/cli.py` & `appthreat_vulnerability_db-6.0.2/vdb/cli.py`

 * *Files identical despite different names*

### Comparing `appthreat-vulnerability-db-6.0.1/vdb/lib/__init__.py` & `appthreat_vulnerability_db-6.0.2/vdb/lib/__init__.py`

 * *Files identical despite different names*

### Comparing `appthreat-vulnerability-db-6.0.1/vdb/lib/aqua.py` & `appthreat_vulnerability_db-6.0.2/vdb/lib/aqua.py`

 * *Files 1% similar despite different names*

```diff
@@ -974,15 +974,15 @@
                 userInteraction="NONE",
                 exploitabilityScore=score,
                 publishedDate=published_date,
                 lastModifiedDate=last_modified_date,
             )
             try:
                 vuln = NvdSource.convert_vuln(orjson.loads(tdata))
-                vuln.description = f"CVE {cve_id} is unfixed in {edition}. See https://security.alpinelinux.org/vuln/{cve_id} for more details."
+                vuln.description = f"{cve_id} is unfixed in {edition}. Visit https://security.alpinelinux.org/vuln/{cve_id} for more details."
                 ret_data.append(vuln)
             except Exception:
                 pass
         return ret_data
 
     @staticmethod
     def nvd_api_to_vuln(cve_data):
```

### Comparing `appthreat-vulnerability-db-6.0.1/vdb/lib/cna.py` & `appthreat_vulnerability_db-6.0.2/vdb/lib/cna.py`

 * *Files identical despite different names*

### Comparing `appthreat-vulnerability-db-6.0.1/vdb/lib/config.py` & `appthreat_vulnerability_db-6.0.2/vdb/lib/config.py`

 * *Files identical despite different names*

### Comparing `appthreat-vulnerability-db-6.0.1/vdb/lib/cve.py` & `appthreat_vulnerability_db-6.0.2/vdb/lib/cve.py`

 * *Files identical despite different names*

### Comparing `appthreat-vulnerability-db-6.0.1/vdb/lib/cve_model/__init__.py` & `appthreat_vulnerability_db-6.0.2/vdb/lib/cve_model/__init__.py`

 * *Files identical despite different names*

### Comparing `appthreat-vulnerability-db-6.0.1/vdb/lib/cve_model/common.py` & `appthreat_vulnerability_db-6.0.2/vdb/lib/cve_model/common.py`

 * *Files identical despite different names*

### Comparing `appthreat-vulnerability-db-6.0.1/vdb/lib/cve_model/cvss_v2.py` & `appthreat_vulnerability_db-6.0.2/vdb/lib/cve_model/cvss_v2.py`

 * *Files identical despite different names*

### Comparing `appthreat-vulnerability-db-6.0.1/vdb/lib/cve_model/cvss_v3.py` & `appthreat_vulnerability_db-6.0.2/vdb/lib/cve_model/cvss_v3.py`

 * *Files identical despite different names*

### Comparing `appthreat-vulnerability-db-6.0.1/vdb/lib/cve_model/tagger.py` & `appthreat_vulnerability_db-6.0.2/vdb/lib/cve_model/tagger.py`

 * *Files identical despite different names*

### Comparing `appthreat-vulnerability-db-6.0.1/vdb/lib/db6.py` & `appthreat_vulnerability_db-6.0.2/vdb/lib/db6.py`

 * *Files 5% similar despite different names*

```diff
@@ -27,15 +27,18 @@
         apsw.Connection, apsw.Connection):
     """Gets the connection to the index and the data databases. Raises apsw.CantOpenError if the database is not available."""
     global db_conn, index_conn, tables_created
     if not db_file.startswith("file:"):
         db_file = f"file:{DB_FILE_SEP}{os.path.abspath(db_file)}"
     if not index_file.startswith("file:"):
         index_file = f"file:{DB_FILE_SEP}{os.path.abspath(index_file)}"
-    flags = apsw.SQLITE_OPEN_URI | apsw.SQLITE_OPEN_NOFOLLOW | (apsw.SQLITE_OPEN_READONLY if read_only else apsw.SQLITE_OPEN_CREATE | apsw.SQLITE_OPEN_READWRITE)
+    rw_flags = apsw.SQLITE_OPEN_URI | apsw.SQLITE_OPEN_NOFOLLOW | apsw.SQLITE_OPEN_CREATE | apsw.SQLITE_OPEN_READWRITE
+    ro_flags = apsw.SQLITE_OPEN_URI | apsw.SQLITE_OPEN_NOFOLLOW | apsw.SQLITE_OPEN_READONLY
+    # To avoid apsw.CantOpenError, we support readonly mode only if the db exists
+    flags = ro_flags if read_only and os.path.exists(db_file) and os.path.exists(index_file) else rw_flags
     if not db_conn:
         db_conn = apsw.Connection(db_file, flags=flags)
     if not index_conn:
         index_conn = apsw.Connection(index_file, flags=flags)
     if not tables_created:
         ensure_schemas(db_conn, index_conn)
         tables_created = True
```

### Comparing `appthreat-vulnerability-db-6.0.1/vdb/lib/gha.py` & `appthreat_vulnerability_db-6.0.2/vdb/lib/gha.py`

 * *Files identical despite different names*

### Comparing `appthreat-vulnerability-db-6.0.1/vdb/lib/npm.py` & `appthreat_vulnerability_db-6.0.2/vdb/lib/npm.py`

 * *Files identical despite different names*

### Comparing `appthreat-vulnerability-db-6.0.1/vdb/lib/nvd.py` & `appthreat_vulnerability_db-6.0.2/vdb/lib/nvd.py`

 * *Files identical despite different names*

### Comparing `appthreat-vulnerability-db-6.0.1/vdb/lib/orasclient.py` & `appthreat_vulnerability_db-6.0.2/vdb/lib/orasclient.py`

 * *Files identical despite different names*

### Comparing `appthreat-vulnerability-db-6.0.1/vdb/lib/osv.py` & `appthreat_vulnerability_db-6.0.2/vdb/lib/osv.py`

 * *Files identical despite different names*

### Comparing `appthreat-vulnerability-db-6.0.1/vdb/lib/search.py` & `appthreat_vulnerability_db-6.0.2/vdb/lib/search.py`

 * *Files identical despite different names*

### Comparing `appthreat-vulnerability-db-6.0.1/vdb/lib/utils.py` & `appthreat_vulnerability_db-6.0.2/vdb/lib/utils.py`

 * *Files 0% similar despite different names*

```diff
@@ -466,25 +466,24 @@
                 return True
             # Handle unaffected case
             if (
                 single_version.startswith("!=")
                 and single_version.removeprefix("!=") == compare_ver
             ):
                 return False
-        else:
-            for apart in vers_parts:
-                apart = apart.strip().replace(" ", "")
-                if apart.startswith(">="):
-                    min_version = apart.removeprefix(">=")
-                elif apart.startswith(">"):
-                    min_excluding = apart.removeprefix(">")
-                if apart.startswith("<="):
-                    max_version = apart.removeprefix("<=")
-                elif apart.startswith("<"):
-                    max_excluding = apart.removeprefix("<")
+        for apart in vers_parts:
+            apart = apart.strip().replace(" ", "")
+            if apart.startswith(">="):
+                min_version = apart.removeprefix(">=")
+            elif apart.startswith(">"):
+                min_excluding = apart.removeprefix(">")
+            if apart.startswith("<="):
+                max_version = apart.removeprefix("<=")
+            elif apart.startswith("<"):
+                max_excluding = apart.removeprefix("<")
     return version_compare(
         compare_ver, min_version, max_version, min_excluding, max_excluding
     )
 
 
 def version_compare(
     compare_ver: str | int | float,
```

