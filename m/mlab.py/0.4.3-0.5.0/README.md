# Comparing `tmp/mlab_py-0.4.3.tar.gz` & `tmp/mlab_py-0.5.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "mlab_py-0.4.3.tar", max compression
+gzip compressed data, was "mlab_py-0.5.0.tar", max compression
```

## Comparing `mlab_py-0.4.3.tar` & `mlab_py-0.5.0.tar`

### file list

```diff
@@ -1,7 +1,8 @@
--rw-r--r--   0        0        0        8 2024-05-22 22:06:07.525956 mlab_py-0.4.3/README.md
--rw-r--r--   0        0        0      179 2024-05-23 09:05:03.314325 mlab_py-0.4.3/pymlab/__init__.py
--rw-r--r--   0        0        0     2626 2024-05-23 09:05:10.242199 mlab_py-0.4.3/pymlab/test.py
--rw-r--r--   0        0        0     2577 2024-05-23 09:05:11.571051 mlab_py-0.4.3/pymlab/train.py
--rw-r--r--   0        0        0     2337 2024-05-23 07:44:20.219924 mlab_py-0.4.3/pymlab/utils.py
--rw-r--r--   0        0        0      371 2024-05-23 09:07:54.006240 mlab_py-0.4.3/pyproject.toml
--rw-r--r--   0        0        0      545 1970-01-01 00:00:00.000000 mlab_py-0.4.3/PKG-INFO
+-rw-r--r--   0        0        0        8 2024-05-22 22:06:07.525956 mlab_py-0.5.0/README.md
+-rw-r--r--   0        0        0      388 2024-05-23 14:35:31.605387 mlab_py-0.5.0/pymlab/__init__.py
+-rw-r--r--   0        0        0     1854 2024-05-23 14:42:03.689669 mlab_py-0.5.0/pymlab/main.py
+-rw-r--r--   0        0        0     2524 2024-05-23 14:45:07.714237 mlab_py-0.5.0/pymlab/test.py
+-rw-r--r--   0        0        0     2176 2024-05-23 14:44:59.601775 mlab_py-0.5.0/pymlab/train.py
+-rw-r--r--   0        0        0     2337 2024-05-23 07:44:20.219924 mlab_py-0.5.0/pymlab/utils.py
+-rw-r--r--   0        0        0      371 2024-05-23 14:47:27.097420 mlab_py-0.5.0/pyproject.toml
+-rw-r--r--   0        0        0      545 1970-01-01 00:00:00.000000 mlab_py-0.5.0/PKG-INFO
```

### Comparing `mlab_py-0.4.3/pymlab/train.py` & `mlab_py-0.5.0/pymlab/train.py`

 * *Files 15% similar despite different names*

```diff
@@ -1,71 +1,67 @@
-import asyncio
+"""
+Do not edit this file
+This is the file that will be used to train your model
+"""
 import os
 import json
 import requests
-from .utils import fetch_parameters,run_in_dir
 
 class TrainResults:
     """Results of training."""
     def __init__(self, pretrained_model: str, metrics: dict[str, float], files: []):
         self.pretrained_model = pretrained_model
         self.metrics = metrics
         self.files = files
 
-def train(
-    model_path:str,
+
+async def train(
+    main, # this is the function that will be called to train the model
     result_id: str,
-    API_URL: str,
-):
+    api_url: str,
+    **kwargs,
+) -> TrainResults:
     """
     Train a model
     This function will provide the dataset path, parameters and result_id
     and will return the results of training.
     """
+    try:
+        metrics, files, pretrained_model = await main(result_id=result_id, api_url=api_url, **kwargs)
 
-    parameters = fetch_parameters(config_path=f"{model_path}/config.txt")
-    DATASET_PATH = str(parameters["dataset_url"]).strip() # type: ignore
+        files = {}
 
-    train_model = getattr(__import__(f"{model_path}.model", fromlist=["train"]), "train")
-    print(train_model)
+        for file in files:
+            filename = file.split("/")[-1]
+            files[filename] = (filename, open(file, 'rb'))
+
+        # Stringify metrics
+        metrics = json.dumps(metrics)
+        data = {
+            "result_id": result_id,
+            "metrics": metrics,
+            "pretrained_model": pretrained_model,
+        }
+
+        response = requests.post(api_url, data=data, files=files,timeout=120)
+
+        if response.status_code == 200:
+            print("Successfully uploaded results")
+            for file in files:
+                os.remove(file)
+        else:
+            print("Error uploading results")
+            raise requests.HTTPError(f"Error uploading results. Status code: {response.status_code}, error: {response.text}")
 
-    try:
-        async def main():
-            print("Training model")
-            model: TrainResults = train_model(dataset_path=DATASET_PATH, parameters=parameters, result_id=result_id)
-            print(model)
-            files = {}
-
-            for file in model.files:
-                filename = file.name
-                files[filename] = file
-
-            # Stringify metrics
-            metrics = json.dumps(model.metrics)
-            data = {
-                "result_id": result_id,
-                "metrics": metrics,
-                "pretrained_model": model.pretrained_model,
-            }
-
-            print("Uploading results")
-            response = requests.post(API_URL, data=data, files=files,timeout=120, verify=False)
-
-            if response.status_code != 200:
-                raise requests.HTTPError(f"Error uploading results. Status code: {response.status_code}, error: {response.text}")
-        print("Running in dir")
-        run_in_dir(model_path, [f"source {model_path}/venv/bin/activate", f"python -m asyncio.run {main()}"])
     except Exception as e:
-        # Append error in error.txt file
-        # First check if error.txt file exists
         if not os.path.exists(f"{result_id}/error.txt"):
             os.mkdir(result_id)
             with open(f"{result_id}/error.txt", "w", encoding="utf-8") as f:
                 f.write(str(e))
         else:
             with open(f"{result_id}/error.txt", "a", encoding="utf-8") as f:
                 f.write(str(e))
         error_file = open(f"{result_id}/error.txt", "rb")
         req_files = {
             "error.txt": error_file,
         }
-        requests.post(API_URL+f"?error={True}", data={"result_id": result_id, "error": str(e)}, files=req_files, timeout=120)
+        requests.post(api_url+f"?error={True}", data={"result_id": result_id, "error": str(e)}, files=req_files, timeout=120)
```

### Comparing `mlab_py-0.4.3/pymlab/utils.py` & `mlab_py-0.5.0/pymlab/utils.py`

 * *Files identical despite different names*

### Comparing `mlab_py-0.4.3/PKG-INFO` & `mlab_py-0.5.0/PKG-INFO`

 * *Files 16% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: mlab.py
-Version: 0.4.3
+Version: 0.5.0
 Summary: Python packages for mlab ecosystem
 Author: Kelvin Nketia-Achiampong
 Author-email: achiampongk22@gmail.com
 Requires-Python: >=3.8,<4.0
 Classifier: Programming Language :: Python :: 3
 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
```

